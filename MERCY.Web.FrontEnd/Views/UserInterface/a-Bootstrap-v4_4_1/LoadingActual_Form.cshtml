@using MERCY.Web.FrontEnd.Helpers;

@{
    string ui_name               = @"a-Bootstrap-v4_4_1";
    UserInterface userInterface  = new UserInterface(ui_name);
    string ui_Folder_ServerSide  = userInterface.Folder_ServerSide;
    string ui_Folder_Client_Side = userInterface.Folder_ClientSide;

    Layout = ui_Folder_ServerSide + "_Layout.cshtml";
}

<style>
#id_menu_ROMTransfer {
    background-color: #000000;
    border-radius: 4px;
    /*opacity: 0.2;*/
    background: rgba(0,0,0,0.2);
    height: 52px;
    margin: 5px 8px;
}

.filter_title {
    color: #232323;
    font-family: 'OpenSans-SemiBold';
    font-size: 14px;
    font-weight: 700;
    line-height: 17px;
    opacity: 0.8700000047683716;
    text-align: left;
    height: 20px;
}

#mercyTable_info, #mercyTable_length, #mercyTable_paginate, #table_ROM_Quality_info, #table_ROM_Quality_length, #table_ROM_Quality_paginate {
    display: none;
}

.mercy_align_right {
    text-align: right !important;
}

.mercy_textbox {
    padding-top: 8px !important;
    padding-bottom: 0px !important;
}

.select2-selection--single{
    height: 34px !important;
}
.select2-selection__choice {
    height: 34px !important;
}
.select2-selection__arrow{
    height: 32px !important;
}

.mercy_text_rom{
    font-size:16px;
    padding: 0px 0px 0px 5px !important;
}

.mercy_Rom_Transfer_Label{
    font-size:18px;
    margin: 0px 0px 0px 10px !important;
    padding: 0px !important;
}

.mercy_text_101 {
    background-color: #ffffff !important;
    border: 1px solid #afafb9 !important;
    border-radius: 4px !important;
    height: 34px !important;
    padding-left: 8px !important;
}

.box_title {
  color: #463191;
  font-family: 'OpenSans-Bold';
  font-size: 14px;
  line-height: 17px;
  text-align: left;
}

#mercyTable__Cargo_Loaded_info
, #mercyTable__FUEL_CONSUMPTION_info
, #mercyTable__DRAFT_SURVEY_info
, #mercyTable__BARGE_SURVEY_info
, #mercyTable__COAL_TEMPERATURE_info{
    display:none;
}

.mercy_input_text:disabled
/*, .mercy_input_text[readonly]*/
, .mercy_text_101:disabled
, .mercy_text_101[readonly]{
    background-color: #eee !important;
    border: 1px solid #aaa !important;
    cursor: not-allowed !important;
}

.ts_file_button {
    height: 25px;
    width: 100px;
    background: blue;
    color: white;
    border: 0;
    -webkit-appearance: none;
    
    color: #FFFFFF;
    /*font-family: 'Poppins-SemiBold';*/
    font-size: 10px;
    font-weight: 400;
    line-height: 12px;
    text-align: left;
    
    background-color: #00B4A5;
    border: 1px solid #AFAFB9;
    border-radius: 4px;
    width: 79px;
    height: 17px;
}

.input_Upload_file {
    background-color: #FFFFFF !important;
    border: 1px solid #AFAFB9 !important;
    border-radius: 4px !important;
    height: 34px !important;
}

.button_Choose_file {
    background-color: #00b4a5 !important;
    border: 1px solid #AFAFB9 !important;
    border-radius: 2px !important;
    width: 73px !important;
    height: 18px !important;
    
    color: #FFFFFF;
    font-family: 'Poppins-SemiBold';
    font-size: 10px;
    line-height: 12px;
    text-align: center;
}

.text_summary {
  color: #00B4A5;
  font-family: 'NotoSans-Bold';
  font-size: 12px;
  line-height: 14px;
}

#tab_Barge_Performance td{
    border: 1px solid #E0E0E0;
    min-height:80px !important;
    padding-left:15px !important;
    width:160px !important;
}

#tab_Barge_Performance td.performance_column_1{
    width:400px !important;
    height:40px;
}

.column_bold{
    height:40px;
    font-weight:bold;
}

.column_bold2{
    height:40px;
    font-weight:bold;
    text-align:center;
}
</style>


<link href="@ui_Folder_Client_Side/css/select2.min.css" rel="stylesheet" />
<script src="@ui_Folder_Client_Side/js/select2.min.js"></script>

<div class="col margin_padding_0 mercy_box_inner">
    <div class="row margin_padding_0 mercy_page_Title">
        Actual Barge Loading
    </div>
    <div class="row margin_padding_0 mercy_page_Title_2">
        Actual Barge > Actual Barge Loading
    </div>
    <div id="box_data_focused" class="row margin_padding_0 mercy_box_inner_content" style="min-height:150px !important;min-width:400px !important;">
        <div class="col-12 col-md">
            <div class="row margin_padding_0 box_title" style="height:20px !important;margin:20px 0px 10px 0px !important;">
                BARGE LOADING
            </div>
            <div class="row margin_padding_0">
                <div class="col-12 col-md margin_padding_0">
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">No. Ref Report</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <input type="hidden" id="txtRequest_Id" value="0"/>
                                <input type="text" id="txtNoRefReport" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder=""/>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Site</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <select id="ddl_Site" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;"></select>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Barge Name</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <input type="text" id="txtBargeName" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="Enter barge name"/>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Barge Size (FT)</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <input type="text" id="txtBargeSize" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="Enter barge size"/>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Arrival Time</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div class="row margin_padding_0" style="min-width:200px !important;">
                                    <div class="col-md margin_padding_0">
                                        <div class="input-group date">
                                            <input id="txtArrivalTime" class="mercy_select mercy_input_text mercy_date" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />
                                            <div class="input-group-prepend">
                                                <span class="input-group-text mercy_date_icon"> </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto margin_padding_0" style="margin-left:0px !important;">
                                        <div style="width: 80px;margin:auto;">
                                            <input type="text" id="txtArrivalTime_Hours" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="HH:MM"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Initial Draft, Hold Cleanless</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div class="row margin_padding_0" style="min-width:200px !important;">
                                    <div class="col-md margin_padding_0">
                                        <div class="input-group date">
                                            <input id="txtInitialDraft" class="mercy_select mercy_input_text mercy_date" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />
                                            <div class="input-group-prepend">
                                                <span class="input-group-text mercy_date_icon"> </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto margin_padding_0" style="margin-left:0px !important;">
                                        <div style="width: 80px;margin:auto;">
                                            <input type="text" id="txtInitialDraft_Hours" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="HH:MM"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Commenced Loading</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div class="row margin_padding_0" style="min-width:200px !important;">
                                    <div class="col-md margin_padding_0">
                                        <div class="input-group date">
                                            <input id="txtCommencedLoading" class="mercy_select mercy_input_text mercy_date" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />
                                            <div class="input-group-prepend">
                                                <span class="input-group-text mercy_date_icon"> </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto margin_padding_0" style="margin-left:0px !important;">
                                        <div style="width: 80px;margin:auto;">
                                            <input type="text" id="txtCommencedLoading_Hours" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="HH:MM"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Completed Loading</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div class="row margin_padding_0" style="min-width:200px !important;">
                                    <div class="col-md margin_padding_0">
                                        <div class="input-group date">
                                            <input id="txtCompletedLoading" class="mercy_select mercy_input_text mercy_date" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />
                                            <div class="input-group-prepend">
                                                <span class="input-group-text mercy_date_icon"> </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto margin_padding_0" style="margin-left:0px !important;">
                                        <div style="width: 80px;margin:auto;">
                                            <input type="text" id="txtCompletedLoading_Hours" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="HH:MM"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Coal Quality / Spec</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;">
                                <input type="text" id="txtCoalQualitySpec" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="Enter coal quality"/>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Surveyor Name</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;">
                                <input type="text" id="txtSurveyorName" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="Enter name"/>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Water Level During Loading (Meter)</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;">
                                <input type="text" id="txtWaterLevelDuringLoading" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="Enter water level"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md margin_padding_0">
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">No. Services Trip</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <input type="text" id="txtNoServicesTrip" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder=""/>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Tug Name</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div id="ddl_TugName_div"><select id="ddl_TugName" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;"></select></div>
                                <input type="text" id="txtTugName" value="" class="shadow-none mercy_text_101" style="width: 100%;display:none;" placeholder="" readonly />
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Route</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <input type="text" id="txtRoute" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="Enter route"/>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Load Type</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <input type="text" id="txtLoadType" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder=""/>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Anchor Up</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div class="row margin_padding_0" style="min-width:200px !important;">
                                    <div class="col-md margin_padding_0">
                                        <div class="input-group date">
                                            <input id="txtAnchorUp" class="mercy_select mercy_input_text mercy_date" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />
                                            <div class="input-group-prepend">
                                                <span class="input-group-text mercy_date_icon"> </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto margin_padding_0" style="margin-left:0px !important;">
                                        <div style="width: 80px;margin:auto;">
                                            <input type="text" id="txtAnchorUp_Hours" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="HH:MM"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Berthed Time</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div class="row margin_padding_0" style="min-width:200px !important;">
                                    <div class="col-md margin_padding_0">
                                        <div class="input-group date">
                                            <input id="txtBerthedTime" class="mercy_select mercy_input_text mercy_date" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />
                                            <div class="input-group-prepend">
                                                <span class="input-group-text mercy_date_icon"> </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto margin_padding_0" style="margin-left:0px !important;">
                                        <div style="width: 80px;margin:auto;">
                                            <input type="text" id="txtBerthedTime_Hours" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="HH:MM"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Unberthing</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div class="row margin_padding_0" style="min-width:200px !important;">
                                    <div class="col-md margin_padding_0">
                                        <div class="input-group date">
                                            <input id="txtUnberthing" class="mercy_select mercy_input_text mercy_date" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />
                                            <div class="input-group-prepend">
                                                <span class="input-group-text mercy_date_icon"> </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto margin_padding_0" style="margin-left:0px !important;">
                                        <div style="width: 80px;margin:auto;">
                                            <input type="text" id="txtUnberthing_Hours" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="HH:MM"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Departure</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <div class="row margin_padding_0" style="min-width:200px !important;">
                                    <div class="col-md margin_padding_0">
                                        <div class="input-group date">
                                            <input id="txtDeparture" class="mercy_select mercy_input_text mercy_date" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />
                                            <div class="input-group-prepend">
                                                <span class="input-group-text mercy_date_icon"> </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto margin_padding_0" style="margin-left:0px !important;">
                                        <div style="width: 80px;margin:auto;">
                                            <input type="text" id="txtDeparture_Hours" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="HH:MM"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Delay Cause of Barge Changing</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;">
                                <select id="ddl_DelayCause_of_BargeChanging" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;">
                                    <option value="">Select</option>
                                    <option value="Waiting Barge">Waiting Barge</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Weather Condition</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;">
                                <select id="ddl_WeatherCondition" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;">
                                    <option value="">Select</option>
                                    <option value="Clear">Clear</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row margin_padding_0" style="min-height: 100px;">
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;">
                            <div style="width:100%" class="filter_title">Daily Water Level (Meter)</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <input type="text" id="txtDailyWaterLevel" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="Enter water level"/>
                            </div>
                        </div>
                        <div class="col-12 col-md margin_padding_0" style="padding-top: 15px !important;padding-bottom: 15px !important;">
                            <div style="width:100%" class="filter_title">Water Level at Jetty (Meter)</div>
                            <div style="width:100%;padding:10px 10px 10px 0px;height:45px;">
                                <input type="text" id="txtWaterLevel_at_Jetty" value="" class="shadow-none mercy_text_101" style="width: 100%;" placeholder="Enter water level"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-auto margin_padding_0" style="padding-top:45px !important;">
            <div style="width:100%;height:20px !important;margin:20px 0px 10px 0px !important;">
            </div>
            <div style="width: 140px;margin:auto;padding-bottom:20px;display:none;" id="btnFinalize_outer">
                <div class="mercy_button" style="width:100px;"><div class="mercy_text_center" id="btnFinalize">Finalize</div></div>
            </div>
            <div style="width: 140px;margin:auto;padding-bottom:20px;display:none;" id="btnSave_outer">
                <div class="mercy_button" style="width:100px;"><div class="mercy_text_center" id="btnSave">Save</div></div>
            </div>
            <div style="width: 140px;margin:auto;padding-bottom:20px;display:none;" id="btnEdit_outer">
                <div class="mercy_button" style="width:100px;"><div class="mercy_text_center" id="btnEdit">Edit Data</div></div>
            </div>
            <div style="width: 140px;margin:auto;">
                <div class="mercy_button_2" style="width:100px;"><div class="mercy_text_center" id="btnCancel">Cancel</div></div>
            </div>
        </div>
    </div>
    <div class="row margin_padding_0 mercy_box_inner_content" style="min-height:150px !important;min-width:400px !important;">
        <div class="col">
            <div class="row margin_padding_0 box_title" style="height:20px !important;margin:20px 0px 10px 0px !important;">
                CARGO LOADED
            </div>
            <div class="row margin_padding_0" style="margin: 10px 0px !important;">
                <div class="mercy_button mercy_button_Add_disable" style="width:100px;" id="btn_Add__Cargo_Loaded"><div class="mercy_text_center">Add New</div></div>
            </div>
            <div class="row margin_padding_0" style="margin: 10px 0px 20px 0px !important;">
                <table id="mercyTable__Cargo_Loaded" class="display nowrap table table-striped table-hover mercy_table mercy_table_header" style="width:100%;">
                    <thead>
                        <tr>
                            <th>RecordId</th>
                            <th>No_Line</th>
                            <th><div style="color:white;text-align: center !important;">Action</div></th>
                            <th>No</th>
                            <th>Tunnel</th>
                            <th>Belt (MT)</th>
                            <th>Draft (MT)</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <div class="row margin_padding_0">
        <div class="col col-md-auto" style="padding-left:0px !important;">
            <div class="row margin_padding_0 mercy_box_inner_content" style="min-height:150px !important;width:350px !important;">
                <div class="col">
                    <div class="row margin_padding_0 box_title" style="height:20px !important;margin:20px 0px 10px 0px !important;">
                        FUEL CONSUMPTION
                    </div>
                    <div class="row margin_padding_0" style="margin: 10px 0px !important;">
                        <div class="mercy_button mercy_button_Add_disable" style="width:100px;" id="btn_Add__FUEL_CONSUMPTION"><div class="mercy_text_center">Add New</div></div>
                    </div>
                    <div class="row margin_padding_0" style="margin: 10px 0px 20px 0px !important;">
                        <table id="mercyTable__FUEL_CONSUMPTION" class="display nowrap table table-striped table-hover mercy_table mercy_table_header" style="width:100%;">
                            <thead>
                                <tr>
                                    <th>RecordId</th>
                                    <th>No_Line</th>
                                    <th><div style="color:white;text-align: center !important;">Action</div></th>
                                    <th>No</th>
                                    <th>Fuel Rob Record</th>
                                    <th>Liters</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col col-md" style="padding-left:0px !important;padding-right:0px !important;">
            <div class="row margin_padding_0 mercy_box_inner_content" style="min-height:150px !important;">
                <div class="col">
                    <div class="row margin_padding_0 box_title" style="height:20px !important;margin:20px 0px 10px 0px !important;">
                        DRAFT SURVEY
                    </div>
                    <div class="row margin_padding_0" style="margin: 10px 0px !important;">
                        <div class="mercy_button mercy_button_Add_disable" style="width:100px;" id="btn_Add__DRAFT_SURVEY"><div class="mercy_text_center">Add New</div></div>
                    </div>
                    <div class="row margin_padding_0" style="margin: 10px 0px 20px 0px !important;">
                        <table id="mercyTable__DRAFT_SURVEY" class="display nowrap table table-striped table-hover mercy_table mercy_table_header" style="width:100%;">
                            <thead>
                                <tr>
                                    <th>RecordId</th>
                                    <th>No_Line</th>
                                    <th><div style="color:white;text-align: center !important;">Action</div></th>
                                    <th>No</th>
                                    <th>Draft Survey Record</th>
                                    <th>Initial</th>
                                    <th>Final</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row margin_padding_0">
        <div class="col col-md" style="padding-left:0px !important;">
            <div class="row margin_padding_0 mercy_box_inner_content" style="min-height:150px !important;min-width:400px !important;">
                <div class="col">
                    <div class="row margin_padding_0 box_title" style="height:20px !important;margin:20px 0px 10px 0px !important;">
                        BARGE SURVEY CONDITION 
                    </div>
                    <div class="row margin_padding_0" style="margin: 10px 0px !important;">
                        <div class="mercy_button mercy_button_Add_disable" style="width:100px;" id="btn_Add__BARGE_SURVEY"><div class="mercy_text_center">Add New</div></div>
                    </div>
                    <div class="row margin_padding_0" style="margin: 10px 0px 20px 0px !important;">
                        <table id="mercyTable__BARGE_SURVEY" class="display nowrap table table-striped table-hover mercy_table mercy_table_header" style="width:100%;">
                            <thead>
                                <tr>
                                    <th>RecordId</th>
                                    <th>No_Line</th>
                                    <th><div style="color:white;text-align: center !important;">Action</div></th>
                                    <th>No</th>
                                    <th>Barge Survey</th>
                                    <th>Conditions</th>
                                    <th>Remarks</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col col-md-auto" style="padding-left:0px !important;padding-right:0px !important;">
            <div class="row margin_padding_0 mercy_box_inner_content" style="min-height:150px !important;width:350px !important;">
                <div class="col">
                    <div class="row margin_padding_0 box_title" style="height:20px !important;margin:20px 0px 10px 0px !important;">
                        COAL TEMPERATURE
                    </div>
                    <div class="row margin_padding_0" style="margin: 10px 0px !important;">
                        <div class="mercy_button mercy_button_Add_disable" style="width:100px;" id="btn_Add__COAL_TEMPERATURE"><div class="mercy_text_center">Add New</div></div>
                    </div>
                    <div class="row margin_padding_0" style="margin: 10px 0px 20px 0px !important;">
                        <table id="mercyTable__COAL_TEMPERATURE" class="display nowrap table table-striped table-hover mercy_table mercy_table_header" style="width:100%;">
                            <thead>
                                <tr>
                                    <th>RecordId</th>
                                    <th>No_Line</th>
                                    <th><div style="color:white;text-align: center !important;">Action</div></th>
                                    <th>No</th>
                                    <th>Coal Temp (C)</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row margin_padding_0 mercy_box_inner_content" style="min-height:150px !important;min-width:400px !important;">
        <div class="col margin_padding_0" style="padding: 0px 0px 0px 15px !important;">
            <div style="">
                <div style="width:100%" class="margin_padding_0 mercy_form_Label">Upload Document</div>
                <div style="width:100%;padding:0px 10px 10px 0px;">
                    <input type="text" class="form-control shadow-none mercy_input_text input_Upload_file" id="txtUploadfile" placeholder="No file selected" readonly/>
                </div>
                <div style="width:100%;padding:10px 20px 10px 0px;margin-top:-53px;text-align:right;">
                    <input type="submit" class="button_Choose_file" value="Choose file" id="btnChooseFile" style="padding: 0px 0px 2px 0px !important;"/>
                </div>
                <div style="width:100%;padding:10px 0px 10px 0px;display:none;" id="files_Uploads_TextBox">
                </div>
                <div style="width:100%;padding:10px 0px 10px 0px;" id="files_Uploads">
                </div>
            </div>
        </div>
    </div>
    <div class="row margin_padding_0 mercy_box_inner_content" style="min-height:150px !important;min-width:400px !important;">
        <div class="col" style="padding-bottom:25px !important;">
            <div class="row margin_padding_0 box_title" style="height:20px !important;margin:20px 0px 10px 0px !important;">
                BARGE PERFORMANCE
            </div>
            <div id="id_Barge_Performance" style="overflow: auto;">
                <table id="tab_Barge_Performance" style="width:3500px;" class="table-striped">
                    <thead>
                        <tr>
                            <td rowspan="3" class="column_bold2" style="width:500px !important;">RECORD ON BARGE LOADING ACTIVITIES</td>
                            <td rowspan="3" class="column_bold2" style="width:180px !important;">Start</td>
                            <td rowspan="3" class="column_bold2" style="width:180px !important;">Complete</td>
                            <td rowspan="2" colspan="2" class="column_bold2">ARRIVAL</td>
                            <td rowspan="2" colspan="6" class="column_bold2">BERTHED (HOURS)</td>
                            <td colspan="7" class="column_bold2">COMM. - COMP.LOADING</td>
                            <td rowspan="2" colspan="2" class="column_bold2">DEPARTURE</td>
                        </tr>
                        <tr>
                            
                            <td class="column_bold2">OPERATION (HOURS)</td>
                            <td colspan="6" class="column_bold2">DELAYS (HOURS)</td>
                        </tr>
                        <tr>
                            <td class="column_bold2">WAITING<br/>BERTH</td>
                            <td class="column_bold2">WAITING<br/>CARGO</td>
                            <td class="column_bold2">BERTHED<br/>TIME</td>
                            <td class="column_bold2">INITIAL DRAFT,<br/>HOLD<br/>CLEANLINESS</td>
                            <td class="column_bold2">LOADING<br/>PREP.&amp;<br/>PM, CM,<br/>CALIBRATION</td>
                            <td class="column_bold2">WAITING<br/>CARGO</td>
                            <td class="column_bold2">Waiting<br/>Barge</td>
                            <td class="column_bold2">BREAKDOWN</td>
                            <td class="column_bold2">ACTUAL LOADED</td>
                            <td class="column_bold2">WAITING<br/>IN LOADING</td>
                            <td class="column_bold2">WAITING<br/>CARGO/ANALYSIS</td>
                            <td class="column_bold2">BREAKDOWN<br/>(conveyor,<br/>electricity etc.)</td>
                            <td class="column_bold2">Change Shift<br/>&amp;Dozers filling<br/>fuel</td>
                            <td class="column_bold2">PM &amp; CM</td>
                            <td class="column_bold2">OTHERS<br/>(weather,<br/>rain, Metal,<br/>Dozer.)</td>
                            <td class="column_bold2">FINAL<br/>DRAFT</td>
                            <td class="column_bold2">WAITING<br/>DOCUMENT</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="performance_column_1 column_bold" style="text-align:center;">BERTHING</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="column_bold">Arrived at pilot station</td>
                            <td id="C60">C60</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Waiting for berthing</td>
                            <td id="C61">C61</td>
                            <td id="D61">D61</td>
                            <td id="E61">E61</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Initial Draft, Hold Cleanliness</td>
                            <td id="C62">C62</td>
                            <td id="D62">D62</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="H62">H62</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="column_bold">Anchor up</td>
                            <td id="C63">C63</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Sailing time to berth (anchor up to first line)</td>
                            <td id="C64">C64</td>
                            <td id="D64">D64</td>
                            <td></td>
                            <td></td>
                            <td id="G64">G64</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="column_bold">Berthing Completed</td>
                            <td id="C65">C65</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Initial Draft, Hold Cleanliness</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Preparation,Preventive, Corrective Maintenance, Calibration</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="I67">I67</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Breakdown (Roller belt of conveyer replace)</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="L68">L68</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Waiting Cargo</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="J69">J69</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Breakdown (Dozer D375)</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Waiting Barge</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="K71">K71</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="column_bold" style="text-align:center;">LOADING</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Loading Commenced</td>
                            <td id="C73">C73</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Loading</td>
                            <td id="C74">C74</td>
                            <td id="D74">D74</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="M74">M74</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Stop loading Bc.5 (Metal detektor, found steel)"Dozer Breakdown"</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="S75">S75</td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Breakdown (Roller belt of conveyer replace, Roller Replace, Conveyor over load)</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="P76">P76</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Over Shift,Dozers filling fuel & Safety talk</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="Q77">Q77</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Start all sistem & Continue loading</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="column_bold">Completed Loading</td>
                            <td id="C79">C79</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Final Draft</td>
                            <td id="C80">C80</td>
                            <td id="D80">D80</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="T80">T80</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="column_bold" style="text-align:center;">UN-BERTHING</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;">Document</td>
                            <td id="C82">C82</td>
                            <td id="D82">D82</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="U82">U82</td>
                        </tr>
                        <tr>
                            <td class="column_bold">Departure</td>
                            <td id="C83">C83</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="height:40px;" class="text_summary"></td>
                            <td></td>
                            <td></td>
                            <td id="E84">E84</td>
                            <td id="F84">F84</td>
                            <td id="G84">G84</td>
                            <td id="H84">H84</td>
                            <td id="I84">I84</td>
                            <td id="J84">J84</td>
                            <td id="K84">K84</td>
                            <td id="L84">L84</td>
                            <td id="M84">M84</td>
                            <td id="N84">N84</td>
                            <td id="O84">O84</td>
                            <td id="P84">P84</td>
                            <td id="Q84">Q84</td>
                            <td id="R84">R84</td>
                            <td id="S84">S84</td>
                            <td id="T84">T84</td>
                            <td id="U84">U84</td>
                        </tr>
                        <tr>
                            <td style="height:40px;" class="text_summary">TOTAL DAYS</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td id="M85">M85</td>
                            <td id="N85">N85</td>
                            <td id="O85">O85</td>
                            <td id="P85">P85</td>
                            <td id="Q85">Q85</td>
                            <td id="R85">R85</td>
                            <td id="S85">S85</td>
                            <td id="T85">T85</td>
                            <td id="U85">U85</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

var is_Editable = false;
var is_Draft = false;

// Flag
var ignore_trigger_change_ddl_Site = false;
var ignore_trigger_change_ddl_Delay = false;
var ignore_trigger_change_ddl_Weather = false;
var ignore_trigger_change_ddl_TugName = false;

// DropdownList
var obj_html_Site = null;
var obj_html_Delay = null;
var obj_html_Weather = null;
var obj_html_TugName = null;

var item_Record = {};
var Default_Actual = null;

$(document).ready(function () {

    $(document).attr('title', 'Actual Barge Loading - Form');
    
    Calculate_Performance_Clear();
    
    $(window).resize(function (){
        // Resize Table: because the Window is Resized
        resize_Table_Detail();
        resize_Table_Performance();
    });
    
    $('#btnSave').click(function (e) {
        SaveData();
    });
    
    $('#btnEdit').click(function (e) {
        Prepare_EditData();
    });

    $('#btnCancel').click(function (e) {
        window.location = mercyUrl('/LoadingActualv');
    });
    
    $('#btnFinalize').click(function (e) {
        FinalizeData();
    });
    
    $("#txtArrivalTime").datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $('#txtArrivalTime').datepicker('update', null);
    $("#txtInitialDraft").datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $('#txtInitialDraft').datepicker('update', null);
    $("#txtAnchorUp").datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $('#txtAnchorUp').datepicker('update', null);
    $("#txtBerthedTime").datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $('#txtBerthedTime').datepicker('update', null);
    
    $("#txtCommencedLoading").datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $('#txtCommencedLoading').datepicker('update', null);
    $("#txtCompletedLoading").datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $('#txtCompletedLoading').datepicker('update', null);
    $("#txtUnberthing").datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $('#txtUnberthing').datepicker('update', null);
    $("#txtDeparture").datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $('#txtDeparture').datepicker('update', null);
    
    $('#btn_Add_Cargo_Loaded').click(function (e) {
        Add_Cargo_Loaded();
    });
    
    $('#btn_Add_Fuel_Consumption').click(function (e) {
        Add_Fuel_Consumption();
    });
    
    $('#btn_Add_Draft_Survey').click(function (e) {
        Add_Draft_Survey();
    });
    
    $('#btn_Add_Barge_Survey_Condition').click(function (e) {
        Add_Barge_Survey_Condition();
    });
    
    $('#btn_Add_Coal_Temperatur').click(function (e) {
        Add_Coal_Temperatur();
    });
    
    $('#btn_Add__Cargo_Loaded').click(function (e){
        processLink_Add__Cargo_Loaded();
    });
    
    $('#btn_Add__FUEL_CONSUMPTION').click(function (e){
        processLink_Add__FUEL_CONSUMPTION();
    });
    
    $('#btn_Add__DRAFT_SURVEY').click(function (e){
        processLink_Add__DRAFT_SURVEY();
    });
    
    $('#btn_Add__BARGE_SURVEY').click(function (e){
        processLink_Add__BARGE_SURVEY();
    });
    
    $('#btn_Add__COAL_TEMPERATURE').click(function (e){
        processLink_Add__COAL_TEMPERATURE();
    });

    $('#btnChooseFile').click(function (e){
        btnChooseFile_Click();
    });
    
    Create_ddl_Site();
    Create_ddl_Delay();
    Create_ddl_Weather();
    Create_ddl_TugName();
    
    Components_Init();

    Load_Page_Form();
});

function Create_ddl_Site() {
    if (obj_html_Site != null) return;

    obj_html_Site = $('#ddl_Site').select2({
        placeholder: 'Select Site'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
    });

    $('#ddl_Site').change(function (e) {
        OnChange_ddl_Site();
    });
}

function OnChange_ddl_Site() {
    if (ignore_trigger_change_ddl_Site) return;
}

function Clear_ddl_Site() {
    // Clear DropdownList
    //$('#ddl_Site').html('').select2({ data: { id: null, text: null } });

    Create_ddl_Site();
}

function Populate_Data_ddl_Site() {
    try {
        var option = null;

        uInfo.Relations.Sites.forEach(
            function (item) {
                // create the option and append to Select2
                option = new Option(item.SiteName, item.SiteId, true, true);
                obj_html_Site.append(option);//.trigger('change');
            }
        );

        // Inisial value for "Site"
        ignore_trigger_change_ddl_Site = true;
        $('#ddl_Site').val('all').trigger('change');
        ignore_trigger_change_ddl_Site = false;
    }catch(err){}
}

function Create_ddl_Delay() {
    if (obj_html_Delay != null) return;

    obj_html_Delay = $('#ddl_DelayCause_of_BargeChanging').select2({
        placeholder: 'Select'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
    });

    $('#ddl_DelayCause_of_BargeChanging').change(function (e) {
        OnChange_ddl_Delay();
    });
}

function OnChange_ddl_Delay() {
    if (ignore_trigger_change_ddl_Delay) return;
}

function Create_ddl_Weather() {
    if (obj_html_Weather != null) return;

    obj_html_Weather = $('#ddl_WeatherCondition').select2({
        placeholder: 'Select'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
    });

    $('#ddl_WeatherCondition').change(function (e) {
        OnChange_ddl_Weather();
    });
}

function OnChange_ddl_Weather() {
    if (ignore_trigger_change_ddl_Weather) return;
}

function SaveData() {
    if (!validate_All()) return;

    $('#imgLoading').show();

    var action = 'Create';
    if (paramid == null || paramid == '') { }
    else action = 'Edit?.id=' + paramid;
    
    var formData = new FormData();
    formData.append('tug', $('#txtTugName').val());
    formData.append('Request_Id', $('#txtRequest_Id').val());
    formData.append('ref_report', $('#txtNoRefReport').val());
    formData.append('site', $('#ddl_Site').val());
    formData.append('service', $('#txtNoServicesTrip').val());
    formData.append('barge', $('#txtBargeName').val());
    formData.append('size', $('#txtBargeSize').val());
    formData.append('route', $('#txtRoute').val());
    formData.append('load_type', $('#txtLoadType').val());

    formData.append('Arrival_Time', $("#txtArrivalTime").data('datepicker').getFormattedDate('yyyy-mm-dd') + ' ' + $("#txtArrivalTime_Hours").val());
    formData.append('Initial_Draft', $("#txtInitialDraft").data('datepicker').getFormattedDate('yyyy-mm-dd') + ' ' + $("#txtInitialDraft_Hours").val());
    formData.append('Anchor_Up', $("#txtAnchorUp").data('datepicker').getFormattedDate('yyyy-mm-dd') + ' ' + $("#txtAnchorUp_Hours").val());
    formData.append('Berthed_Time', $("#txtBerthedTime").data('datepicker').getFormattedDate('yyyy-mm-dd') + ' ' + $("#txtBerthedTime_Hours").val());
    formData.append('Commenced_Loading', $("#txtCommencedLoading").data('datepicker').getFormattedDate('yyyy-mm-dd') + ' ' + $("#txtCommencedLoading_Hours").val());
    formData.append('Completed_Loading', $("#txtCompletedLoading").data('datepicker').getFormattedDate('yyyy-mm-dd') + ' ' + $("#txtCompletedLoading_Hours").val());
    formData.append('Unberthing', $("#txtUnberthing").data('datepicker').getFormattedDate('yyyy-mm-dd') + ' ' + $("#txtUnberthing_Hours").val());
    formData.append('Departure', $("#txtDeparture").data('datepicker').getFormattedDate('yyyy-mm-dd') + ' ' + $("#txtDeparture_Hours").val());

    formData.append('coal_quality', $('#txtCoalQualitySpec').val());
    formData.append('delay_cause', $('#ddl_DelayCause_of_BargeChanging').val());
    formData.append('surveyor', $('#txtSurveyorName').val());
    formData.append('weather', $('#ddl_WeatherCondition').val());
    formData.append('Water_Level_During_Loading', $('#txtWaterLevelDuringLoading').val());
    formData.append('Daily_Water_Level', $('#txtDailyWaterLevel').val());
    formData.append('Water_Level_at_Jetty', $('#txtWaterLevel_at_Jetty').val());

    formData.append('Detail_CargoLoaded', processParameters__Cargo_Loaded());
    formData.append('Detail_FUEL_CONSUMPTION', processParameters__FUEL_CONSUMPTION());
    formData.append('Detail_DRAFT_SURVEY', processParameters__DRAFT_SURVEY());
    formData.append('Detail_BARGE_SURVEY', processParameters__BARGE_SURVEY());
    formData.append('Detail_COAL_TEMPERATURE', processParameters__COAL_TEMPERATURE());

    try{
        var file_Counter = 0;
        var file_recordId = null;

        var file_Deleted_Separator = '';
        var file_Deleted = '';

        $.each(object_id_Created__File_Upload, function(i, val){
            file_recordId = $('#fileInput_Display_c_' + val).val();
            if (file_recordId == null || file_recordId == '' || file_recordId == '-1'){
                file_recordId = '-1';
            }
            
            if (object_id_Deleted__File_Upload.indexOf(val) !== -1){
                // this Row will be Deleted
                file_Deleted += file_Deleted_Separator + file_recordId;
                file_Deleted_Separator = ',';
            }else {
                file_Counter++;
                formData.append('fileInput_Upload_' + file_Counter.toString(), $('#fileInput_Upload_' + val)[0].files[0]);
            }
        });

        $.each(object_id_Deleted__File_Upload, function(i, val){
            file_recordId = $('#fileInput_Display_c_' + val).val();
            if (file_recordId == null || file_recordId == '' || file_recordId == '-1'){
                file_recordId = '-1';
            }
            
            // this Row will be Deleted
            file_Deleted += file_Deleted_Separator + file_recordId;
            file_Deleted_Separator = ',';
        });

        formData.append('file_Counter', file_Counter);
        formData.append('file_Deleted', file_Deleted);
    }catch(err){}

    $.ajax({
        url: api_Request + '/Api/LoadingActual/' + action,
        data: formData,
        processData: false,  // tell jQuery not to process the data
        contentType: false,  // tell jQuery not to set contentType
        type: 'POST',
        dataType: "json",
        cache: false,
        beforeSend: function (request) {
            request.setRequestHeader(MERCY_Token, MERCY_Token_Value);
        },
        success: function (data) {
            $('#imgLoading').hide();

            if ( ! $.trim(data)) {
                // empty data
                return;
            }
            
            if ( ! data.Success){
                alert(data.Message);
                return;
            }
            
            alert('Success Save');
            window.location = mercyUrl('/LoadingActualv');
        },
        error: function (error) {
            //$(this).remove();
        }
    });
}

function validate_All() {
    if ($("#txtTugName").val() == '') {
        alert('Tug Name must not be empty!');
        return false;
    }
    if ($("#txtNoRefReport").val() == '') {
        alert('No. Ref Report must not be empty!');
        return false;
    }
    if ($("#ddl_Site").val() == ''
        || $("#ddl_Site").val() == null) {
        alert('Site must not be empty!');
        return false;
    }
    if ($("#txtNoServicesTrip").val() == '') {
        alert('No. Services Trip must not be empty!');
        return false;
    }
    if ($("#txtBargeName").val() == '') {
        alert('Barge Name must not be empty!');
        return false;
    }
    if ( ! Is_Valid_Numeric('#txtBargeSize')){
        alert('[Barge size] must Valid Integer value!');
        return false;
    }
    if ($("#txtBargeSize").val().includes(".")) {
        alert('[Barge size] must Valid Integer value!');
        return false;
    }
    if ($("#txtRoute").val() == '') {
        alert('Route must not be empty!');
        return false;
    }
    if ($("#txtLoadType").val() == '') {
        alert('Load Type must not be empty!');
        return false;
    }
    if ($("#txtArrivalTime").val() == '') {
        alert('[Arrival Time] must not be empty!');
        return false;
    }
    if ($("#txtInitialDraft").val() == '') {
        alert('[Initial Draft, Hold Cleanless] must not be empty!');
        return false;
    }
    if ($("#txtAnchorUp").val() == '') {
        alert('[Anchor Up] must not be empty!');
        return false;
    }
    if ($("#txtBerthedTime").val() == '') {
        alert('[Berthed Time] must not be empty!');
        return false;
    }
    if ($("#txtCommencedLoading").val() == '') {
        alert('[Commenced Loading] must not be empty!');
        return false;
    }
    if ($("#txtCompletedLoading").val() == '') {
        alert('[Completed Loading] must not be empty!');
        return false;
    }
    if ($("#txtUnberthing").val() == '') {
        alert('[Unberthing] must not be empty!');
        return false;
    }
    if ($("#txtDeparture").val() == '') {
        alert('[Departure] must not be empty!');
        return false;
    }
    if ($("#txtCoalQualitySpec").val() == '') {
        alert('Coal Quality / Spec must not be empty!');
        return false;
    }
    if ($("#ddl_DelayCause_of_BargeChanging").val() == ''
        || $("#ddl_DelayCause_of_BargeChanging").val() == null) {
        alert('[Delay Cause of Barge Changing] must not be empty!');
        return false;
    }
    if ($("#txtSurveyorName").val() == '') {
        alert('Surveyor Name must not be empty!');
        return false;
    }
    if ($("#ddl_WeatherCondition").val() == ''
        || $("#ddl_WeatherCondition").val() == null) {
        alert('[Weather Condition] must not be empty!');
        return false;
    }
    if ( ! Is_Valid_Numeric('#txtWaterLevelDuringLoading')){
        alert('[Water Level During Loading] must Valid Numeric value!');
        return;
    }
    if ( ! Is_Valid_Numeric('#txtDailyWaterLevel')){
        alert('[Daily Water Level] must Valid Numeric value!');
        return;
    }
    if ( ! Is_Valid_Numeric('#txtWaterLevel_at_Jetty')){
        alert('[Water Level at Jetty] must Valid Numeric value!');
        return;
    }
    
    if ( ! isValid__Cargo_Loaded()){
        alert(detail_Message);
        return;
    }
    if ( ! isValid__FUEL_CONSUMPTION()){
        alert(detail_Message);
        return;
    }
    if ( ! isValid__DRAFT_SURVEY()){
        alert(detail_Message);
        return;
    }
    if ( ! isValid__BARGE_SURVEY()){
        alert(detail_Message);
        return;
    }
    if ( ! isValid__COAL_TEMPERATURE()){
        alert(detail_Message);
        return;
    }
    
    return true;
}

var detail_Message = '';

function DisplayData() {
    $.ajax({
        url: api_Request + '/Api/LoadingActual/Get',
        type: 'GET',
        data: {u_menu:get_user_menu, u_relation:get_user_relation, '.id':paramid},
        dataType: "json",
        cache: false,
        beforeSend: function (request) {
            request.setRequestHeader(MERCY_Token, MERCY_Token_Value);
        },
        success: function (data) {
            $('#imgLoading').hide();

            if ( ! $.trim(data)) {
                // empty data
                return;
            }
            
            if ( ! data.Success){
                // special case: Id not found
                if (data.Message.indexOf('not found') !== -1){
                    after_GetUserInfo(data.User);
                    uInfo = data.User;
                }
            
                alert(data.Message);
                
                window.location = '/NoAccess';
                return;
            }
            
            // we need "Permission" information
            permission = data.Permission;
            
            Ref_Tunnels = data.Ref_Tunnels;
            Ref_Fuel_Rob = data.Ref_Fuel_Rob;
            Ref_Draft_Survey = data.Ref_Draft_Survey;
            Ref_Barge_Survey_Condition = data.Ref_Barge_Survey_Condition;
            
            // Special Purpose, getting information of CurrentUser
            if (get_user_menu == '1'){
                after_GetUserInfo(data.User);
                uInfo = data.User;
                
                resize_Table_Performance();
            
                Populate_Data_ddl_Site();
                
                Populate_DataGrid__Cargo_Loaded(data.Cargo_Loaded);
                Populate_DataGrid__FUEL_CONSUMPTION(data.Fuel_Consumption);
                Populate_DataGrid__DRAFT_SURVEY(data.Draft_Survey);
                Populate_DataGrid__BARGE_SURVEY(data.Barge_Survey_Condition);
                Populate_DataGrid__COAL_TEMPERATURE(data.Coal_Temperature);
                Populate_Attachments(data.Attachments);
            }
            
            // reset
            get_user_menu = '0';
            get_user_relation = '0';
            
            // make it "Intuitive"
            Display_Components();
            Display_Buttons_Form();
            Display_Buttons_Form_Actual_Loading();
            
            if (Mode_Create()){
                // Stop here
                // data.Item is null
                
                Display_Buttons_Form_Actual_Loading_Add_Item();
                
                Default_Actual = data.Default_Actual;
                Populate_Data_ddl_TugName();
                
                return;
            }
            
            $('#ddl_TugName_div').hide();
            $('#txtTugName').show();
            
            item_Record = data.Item;
            
            is_Draft = (item_Record.Status == 'Draft');
            
            $('#txtTugName').val(item_Record.TugName);
            $("#txtNoRefReport").val(item_Record.No_Ref_Report);
            $("#ddl_Site").val(item_Record.SiteId).trigger('change');
            $("#txtNoServicesTrip").val(item_Record.No_Services_Trip);
            $("#txtBargeName").val(item_Record.Barge_Name);
            $("#txtBargeSize").val(item_Record.Barge_Size);
            $("#txtRoute").val(item_Record.Route);
            $("#txtLoadType").val(item_Record.Load_Type);
            
            Set_Date('#txtArrivalTime', item_Record.Arrival_Time);
            Set_Date('#txtInitialDraft', item_Record.Initial_Draft);
            Set_Date('#txtAnchorUp', item_Record.Anchor_Up);
            Set_Date('#txtBerthedTime', item_Record.Berthed_Time);
            Set_Date('#txtCommencedLoading', item_Record.Commenced_Loading);
            Set_Date('#txtCompletedLoading', item_Record.Completed_Loading);
            Set_Date('#txtUnberthing', item_Record.Unberthing);
            Set_Date('#txtDeparture', item_Record.Departure);
            
            $("#txtArrivalTime_Hours").val(item_Record.Arrival_Str2);
            $("#txtInitialDraft_Hours").val(item_Record.Initial_Draft_Str2);
            $("#txtAnchorUp_Hours").val(item_Record.Anchor_Up_Str2);
            $("#txtBerthedTime_Hours").val(item_Record.Berthed_Time_Str2);
            $("#txtCommencedLoading_Hours").val(item_Record.Commenced_Loading_Str2);
            $("#txtCompletedLoading_Hours").val(item_Record.Completed_Loading_Str2);
            $("#txtUnberthing_Hours").val(item_Record.Unberthing_Str2);
            $("#txtDeparture_Hours").val(item_Record.Departure_Str2);

            $("#txtCoalQualitySpec").val(item_Record.Coal_Quality_Spec);
            $("#ddl_DelayCause_of_BargeChanging").val(item_Record.Delay_Cause_of_Barge_Changing).trigger('change');
            $("#txtSurveyorName").val(item_Record.Surveyor_Name);
            $("#ddl_WeatherCondition").val(item_Record.Weather_Condition).trigger('change');
            $("#txtWaterLevelDuringLoading").val(item_Record.Water_Level_During_Loading);
            $("#txtDailyWaterLevel").val(item_Record.Daily_Water_Level);
            $("#txtWaterLevel_at_Jetty").val(item_Record.Water_Level_at_Jetty);
            
            Calculate_Performance();
        },
        error: function (error) {
            //$(this).remove();
        }
    });
}

function Display_Components(){
    $("#txtTugName").attr("disabled", true);
    $("#txtNoRefReport").attr("disabled", true);
    $("#ddl_Site").attr("disabled", true);
    $("#txtNoServicesTrip").attr("disabled", true);
    $("#txtBargeName").attr("disabled", true);
    $("#txtBargeSize").attr("disabled", true);
    $("#txtRoute").attr("disabled", true);
    $("#txtLoadType").attr("disabled", true);
    $("#txtArrivalTime").attr("disabled", true);
    $("#txtInitialDraft").attr("disabled", true);
    $("#txtAnchorUp").attr("disabled", true);
    $("#txtBerthedTime").attr("disabled", true);
    $("#txtCommencedLoading").attr("disabled", true);
    $("#txtCompletedLoading").attr("disabled", true);
    $("#txtUnberthing").attr("disabled", true);
    $("#txtDeparture").attr("disabled", true);
    $("#txtCoalQualitySpec").attr("disabled", true);
    $("#ddl_DelayCause_of_BargeChanging").attr("disabled", true);
    $("#txtSurveyorName").attr("disabled", true);
    $("#ddl_WeatherCondition").attr("disabled", true);
    $("#txtWaterLevelDuringLoading").attr("disabled", true);
    $("#txtDailyWaterLevel").attr("disabled", true);
    $("#txtWaterLevel_at_Jetty").attr("disabled", true);
    
    $("#txtArrivalTime_Hours").attr("disabled", true);
    $("#txtInitialDraft_Hours").attr("disabled", true);
    $("#txtCommencedLoading_Hours").attr("disabled", true);
    $("#txtCompletedLoading_Hours").attr("disabled", true);
    $("#txtAnchorUp_Hours").attr("disabled", true);
    $("#txtBerthedTime_Hours").attr("disabled", true);
    $("#txtUnberthing_Hours").attr("disabled", true);
    $("#txtDeparture_Hours").attr("disabled", true);
    
    is_Editable = false;
    
    if (Mode_Create()){
        // check based on Permission
        if (permission.Is_Add){
            is_Editable = true;
        }
    }
    
    if (Mode_Edit()){
        // check based on Permission
        if (permission.Is_Edit){
            is_Editable = true;
        }
    }
    
    if (is_Editable){
        $("#txtTugName").attr("disabled", false);
        //$("#txtNoRefReport").attr("disabled", false);
        $("#ddl_Site").attr("disabled", false);
        //$("#txtNoServicesTrip").attr("disabled", false);
        $("#txtBargeName").attr("disabled", false);
        $("#txtBargeSize").attr("disabled", false);
        $("#txtRoute").attr("disabled", false);
        //$("#txtLoadType").attr("disabled", false);
        $("#txtArrivalTime").attr("disabled", false);
        $("#txtInitialDraft").attr("disabled", false);
        $("#txtAnchorUp").attr("disabled", false);
        $("#txtBerthedTime").attr("disabled", false);
        $("#txtCommencedLoading").attr("disabled", false);
        $("#txtCompletedLoading").attr("disabled", false);
        $("#txtUnberthing").attr("disabled", false);
        $("#txtDeparture").attr("disabled", false);
        $("#txtCoalQualitySpec").attr("disabled", false);
        $("#ddl_DelayCause_of_BargeChanging").attr("disabled", false);
        $("#txtSurveyorName").attr("disabled", false);
        $("#ddl_WeatherCondition").attr("disabled", false);
        $("#txtWaterLevelDuringLoading").attr("disabled", false);
        $("#txtDailyWaterLevel").attr("disabled", false);
        $("#txtWaterLevel_at_Jetty").attr("disabled", false);
        
        $("#txtArrivalTime_Hours").attr("disabled", false);
        $("#txtInitialDraft_Hours").attr("disabled", false);
        $("#txtCommencedLoading_Hours").attr("disabled", false);
        $("#txtCompletedLoading_Hours").attr("disabled", false);
        $("#txtAnchorUp_Hours").attr("disabled", false);
        $("#txtBerthedTime_Hours").attr("disabled", false);
        $("#txtUnberthing_Hours").attr("disabled", false);
        $("#txtDeparture_Hours").attr("disabled", false);
    }
}

function Prepare_EditData(){
    if ( ! is_Draft){
        alert("Status: Final, data can't be modified!");
        return;
    }
    
    is_mode_edit = true;
    
    Display_Components();
    Display_Buttons_Form();
    Display_Buttons_Form_Actual_Loading();
    Display_Buttons_Form_Actual_Loading_Add_Item();
}

function Display_Buttons_Form_Actual_Loading(){
    // for this Form, always use Save {instead of Submit}
    $("#btnSave").text('Save');
    
    // always reset
    $('#btnFinalize_outer').hide();
    
    try {
        if (Mode_View() || Mode_Edit()){
            // check based on Permission
            if (permission.Is_Active){
                $('#btnFinalize_outer').show();
                
                //return;
            }
        }
    }catch(err){}
}

function Display_Buttons_Form_Actual_Loading_Add_Item(){
    if ( ! is_Editable){
        $('#btn_Add__Cargo_Loaded').addClass('mercy_button_Add_disable');
        $('#btn_Add__FUEL_CONSUMPTION').addClass('mercy_button_Add_disable');
        $('#btn_Add__DRAFT_SURVEY').addClass('mercy_button_Add_disable');
        $('#btn_Add__BARGE_SURVEY').addClass('mercy_button_Add_disable');
        $('#btn_Add__COAL_TEMPERATURE').addClass('mercy_button_Add_disable');
        
    }
    else{
        $('#btn_Add__Cargo_Loaded').removeClass('mercy_button_Add_disable');
        $('#btn_Add__FUEL_CONSUMPTION').removeClass('mercy_button_Add_disable');
        $('#btn_Add__DRAFT_SURVEY').removeClass('mercy_button_Add_disable');
        $('#btn_Add__BARGE_SURVEY').removeClass('mercy_button_Add_disable');
        $('#btn_Add__COAL_TEMPERATURE').removeClass('mercy_button_Add_disable');
    }
}

function ViewOnly_ddl_Company() {}

function Components_Init(){
    $('#txtTugName').val('');
    $("#txtNoRefReport").val('');
    $("#txtNoServicesTrip").val('');
    $("#txtBargeName").val('');
    $("#txtBargeSize").val('');
    $("#txtRoute").val('');
    $("#txtLoadType").val('');
    
    $("#txtCoalQualitySpec").val('');
    $("#txtSurveyorName").val('');
    $("#txtWaterLevelDuringLoading").val('');
    $("#txtDailyWaterLevel").val('');
    $("#txtWaterLevel_at_Jetty").val('');
    
    $("#txtArrivalTime_Hours").val('');
    $("#txtInitialDraft_Hours").val('');
    $("#txtCommencedLoading_Hours").val('');
    $("#txtCompletedLoading_Hours").val('');
    $("#txtAnchorUp_Hours").val('');
    $("#txtBerthedTime_Hours").val('');
    $("#txtUnberthing_Hours").val('');
    $("#txtDeparture_Hours").val('');
}

function Is_Valid_Numeric(p_id){
    var val_x = $(p_id).val().replace(',', '');
    
    if ($.isNumeric(val_x)){
        return true;
    }
    
    return false;
}

function Clear_DataGrid_(p_id){
    try {
        $('#' + p_id).DataTable().clear().destroy();
        //$('#'+p_id).DataTable().destroy();
    }catch(err){}
    
    try {
        $('#'+p_id+' tbody').empty();
    }catch(err){}
}

function resize_Table_Detail(){
    return;
    $("#mercyTable__Cargo_Loaded_wrapper").width('100%');
    $("#mercyTable__FUEL_CONSUMPTION_wrapper").width('100%');
    $("#mercyTable__DRAFT_SURVEY_wrapper").width('100%');
    $("#mercyTable__BARGE_SURVEY_wrapper").width('100%');
    $("#mercyTable__COAL_TEMPERATURE_wrapper").width('100%');
}

function resize_Table_Performance() {
    if ($.cookie(MERCY_C_HIDE) == '1'){
        $("#id_Barge_Performance").width('100%');
        return;
    }
    
    if ($('.mercy-sidebar').is(":hidden")){
        $("#id_Barge_Performance").width('100%');
        return;
    }
    
    var width_outer = $('.mercy-box-outer').width();
    var width_sidebar = $('.mercy-sidebar').width();

    var width_additional = 20 + 20 + 40 + 10 + resize_Table_additional;
    var width_table = width_outer - width_sidebar - width_additional;
    if (width_table <= 0) {
        width_table = '100%';
    }
    
    $("#id_Barge_Performance").width(width_table);
}

function Set_Date(p_id, p_value){
    var parsedDate = new Date(parseInt(p_value.substr(6)));
    d = new Date(parsedDate);
    $(p_id).datepicker('update', d);
}

var obj_html_Table__Cargo_Loaded;
var str_name_Table__Cargo_Loaded = '#mercyTable__Cargo_Loaded';

var lineNumber_Data__Cargo_Loaded = 0;
var object_Created_Count__Cargo_Loaded = 0;
var object_id_additional__Cargo_Loaded = ''; // pattern is: '_' + object_Created_Count + '_' + lineNumber_Data;
var object_id_Created__Cargo_Loaded = [];
var object_id_Deleted__Cargo_Loaded = [];

function Create_Table__Cargo_Loaded(){

    Clear_DataGrid_(str_name_Table__Cargo_Loaded);
    
    try {
        obj_html_Table__Cargo_Loaded = $(str_name_Table__Cargo_Loaded).DataTable({
            "bAutoWidth": false
            , "bFilter": false
            , "dom": '<"top">rt<"bottom"iflp><"clear">'
            , "scrollX": true
            , "scrollY": false //"200px"
            //, "scrollCollapse": true
            , "paging": false
            //, "ordering": false
            , "columns": [
                { "data": "RecordId", "name": "RecordId", "autoWidth": true }
                , {
                    render: function (data, type, full, meta){
                        return lineNumber_Data__Cargo_Loaded;
                    }
                    , visible: false
                }
                , {
                    render: function (data, type, full, meta) {
                        return '<div style="width:50px !important;">'+
                                '<input type="hidden" id="data_RecordId__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" value="' + full.RecordId + '"/>' +
                                '<input type="hidden" id="data_still_Edited__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" value="0"/>' +
                                '<input type="hidden" id="data_Confirm__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" value="0"/>' +
                                '<i id="data_link_Edit__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" onclick="javascript:processLink_Edit__Cargo_Loaded(this)" class="fa fa-edit" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'display:none;':'') + '" title="Edit"></i>' +
                                '<i id="data_link_Delete__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" onclick="javascript:processLink_Delete__Cargo_Loaded(this)" class="fa fa-trash" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'display:none;':'') + '" title="Delete"></i>' +
                                '<i id="data_link_Confirm__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" onclick="javascript:processLink_Confirm__Cargo_Loaded(this)" class="fa fa-check" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'':'display:none;') + '" title="Confirm"></i>' +
                                '<i id="data_link_Cancel__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" onclick="javascript:processLink_Cancel__Cargo_Loaded(this)" class="fa fa-times" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'':'display:none;') + '" title="Cancel"></i>'
                                '</div>'
                                ;
                    }
                    , className: "mercy_action_icon"
                    , orderable: false
                    , width: "50px"
                }
                , {
                    "render": function (data, type, full, meta){
                        return (full.RecordId==-1?'':lineNumber_Data__Cargo_Loaded.toString() + '.');
                    }
                    , className: "mercy_text_right"
                    , orderable: false
                    , width: "20px"
                    , visible: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Tunnel_label__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '">' + full.TunnelName + '</span>' +
                               '<input type="hidden" id="data_Tunnel_id__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" value="' + full.TunnelId + '"/>' +
                               '<div id="data_Tunnel_txt_div__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" style="width:100%;' + (full.RecordId==-1?'':'display:none;') + '">' +
                               '<select id="data_Tunnel_txt__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;"></select>'
                               '</div>'
                               ;
                    }
                    , width: "200px"
                    , orderable: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Belt_label__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '">' + full.Belt + '</span>' +
                               '<input type="text" id="data_Belt_txt__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" class="shadow-none mercy_text_101" value="" ' + ' style="width:100%;' + (full.RecordId==-1?'':'display:none;') + '"/>'
                               ;
                    }
                    , width: "100px"
                    , orderable: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Draft_label__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '">' + full.Draft + '</span>' +
                               '<input type="text" id="data_Draft_txt__Cargo_Loaded' + object_id_additional__Cargo_Loaded + '" class="shadow-none mercy_text_101" value="" ' + ' style="width:100px;' + (full.RecordId==-1?'':'display:none;') + '"/>'
                               ;
                    }
                    , orderable: false
                }
            ]
            , "columnDefs": [
                {
                    "targets": [0],
                    "visible": false,
                    "searchable": false
                }
            ]
            //, "order": [[3, 'desc'], [4, 'asc']]
            , "order": [[1, 'asc']]
        });

        obj_html_Table__Cargo_Loaded.on('draw', function () {});
        
        // Resize Table: because this DataTable is newly created
        //resize_Table();
        $("#mercyTable__Cargo_Loaded_wrapper").width('100%');
    }catch(err){}
}

function Populate_DataGrid__Cargo_Loaded(p_data){
    Create_Table__Cargo_Loaded();
    
    // reset
    lineNumber_Data__Cargo_Loaded = 0;
    object_id_Created__Cargo_Loaded = [];
    object_id_Deleted__Cargo_Loaded = [];
    
    try{
        p_data.forEach(
            function (item){
                object_Created_Count__Cargo_Loaded++;
                lineNumber_Data__Cargo_Loaded++;
                object_id_additional__Cargo_Loaded = '_' + object_Created_Count__Cargo_Loaded.toString() + '_' + lineNumber_Data__Cargo_Loaded.toString();
                
                // save to Array
                object_id_Created__Cargo_Loaded.push(object_id_additional__Cargo_Loaded);
                
                // add to Table
                obj_html_Table__Cargo_Loaded.row.add(item).draw(false);
                
                var target_id_additional = '__Cargo_Loaded' + object_id_additional__Cargo_Loaded;
    
                Create_ddl__Cargo_Loaded_Tunnel('#data_Tunnel_txt' + target_id_additional.toString());
            }
        );
    }catch(err){}
}

function processLink_Add__Cargo_Loaded(){
    if ( ! is_Editable) return;
    
    // create "Record_Item"
    var item = {CreatedOn_Str:'', CreatedOn_Str2:'', FullName:''
                    // flag for "New Record"
                    , RecordId:-1
                    , TunnelId:-1, TunnelName: '', Belt:0, Draft:0
                    , CreatedBy: 0, CreatedOn : null
                    , LastModifiedBy : 0, LastModifiedOn : null}
    
    // do "Counting"
    object_Created_Count__Cargo_Loaded++;
    lineNumber_Data__Cargo_Loaded++;
    object_id_additional__Cargo_Loaded = '_' + object_Created_Count__Cargo_Loaded.toString() + '_' + lineNumber_Data__Cargo_Loaded.toString();
    
    // save to Array
    object_id_Created__Cargo_Loaded.push(object_id_additional__Cargo_Loaded);
    
    // add to Table
    obj_html_Table__Cargo_Loaded.row.add(item).draw(false);
    
    var target_id_additional = '__Cargo_Loaded' + object_id_additional__Cargo_Loaded;
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    Create_ddl__Cargo_Loaded_Tunnel('#data_Tunnel_txt' + target_id_additional.toString());
    
    // Firstly, copy data
    //$('#data_Tunnel_txt' + target_id_additional).val($('#data_Tunnel_id' + target_id_additional).val()).trigger('change');
    $('#data_Belt_txt' + target_id_additional).val($('#data_Belt_label' + target_id_additional).text());
    $('#data_Draft_txt' + target_id_additional).val($('#data_Draft_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_Tunnel_label' + target_id_additional).hide();
    $('#data_Tunnel_txt_div' + target_id_additional).show();
    $('#data_Belt_label' + target_id_additional).hide();
    $('#data_Belt_txt' + target_id_additional).show();
    $('#data_Draft_label' + target_id_additional).hide();
    $('#data_Draft_txt' + target_id_additional).show();
}

function processLink_Edit__Cargo_Loaded(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Edit', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).hide();
    $('#data_link_Delete' + target_id_additional).hide();
    $('#data_link_Confirm' + target_id_additional).show();
    $('#data_link_Cancel' + target_id_additional).show();
    
    // Firstly, copy data
    $('#data_Tunnel_txt' + target_id_additional).val($('#data_Tunnel_id' + target_id_additional).val()).trigger('change');
    $('#data_Belt_txt' + target_id_additional).val($('#data_Belt_label' + target_id_additional).text());
    $('#data_Draft_txt' + target_id_additional).val($('#data_Draft_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_Tunnel_label' + target_id_additional).hide();
    $('#data_Tunnel_txt_div' + target_id_additional).show();
    $('#data_Belt_label' + target_id_additional).hide();
    $('#data_Belt_txt' + target_id_additional).show();
    $('#data_Draft_label' + target_id_additional).hide();
    $('#data_Draft_txt' + target_id_additional).show();
}

function processLink_Cancel__Cargo_Loaded(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Cancel', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // set Show/Hide
    $('#data_Tunnel_label' + target_id_additional).show();
    $('#data_Tunnel_txt_div' + target_id_additional).hide();
    $('#data_Belt_label' + target_id_additional).show();
    $('#data_Belt_txt' + target_id_additional).hide();
    $('#data_Draft_label' + target_id_additional).show();
    $('#data_Draft_txt' + target_id_additional).hide();
    
    var recordId = $('#data_RecordId' + target_id_additional).val();
    if (recordId == '-1'){
        // this action = 'Create';
    }else{
        // this action = 'Edit';
        return;
    }
    
    try {
        var lineFound = -1;
        var line = 0;
        $.each(object_id_Created__Cargo_Loaded, function( i, val ){
            line++;
            if ('__Cargo_Loaded' + val == target_id_additional)
            {
                lineFound = line;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__Cargo_Loaded + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
        }
    }catch(err){}
}

function processLink_Delete__Cargo_Loaded(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Delete', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    /*if (lineNumber_Data<=1){
        alert('Data is only 1. Please do not delete it!');
        return;
    }
    if (lineNumber_Data<= (object_id_Deleted.length+1)){
        alert('Enough for Delete!');
        return;
    }*/
    
    try {
        var lineFound = -1;
        var line = 0;
        var id_deleted = '';
        
        $.each(object_id_Created__Cargo_Loaded, function( i, val ){
            line++;
            if ('__Cargo_Loaded' + val == target_id_additional)
            {
                lineFound = line;
                id_deleted = val;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__Cargo_Loaded + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
            
            // save to Array
            object_id_Deleted__Cargo_Loaded.push(id_deleted);
        }
    }catch(err){}
}

function processLink_Confirm__Cargo_Loaded(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Confirm', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('1');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // Firstly, copy data
    var tunnel_value = $('#data_Tunnel_txt' + target_id_additional).select2('data');
    var tunnel = tunnel_value[0];
    
    $('#data_Tunnel_label' + target_id_additional).text(tunnel.text);
    $('#data_Tunnel_id' + target_id_additional).val(tunnel.id);
    $('#data_Belt_label' + target_id_additional).text($('#data_Belt_txt' + target_id_additional).val());
    $('#data_Draft_label' + target_id_additional).text($('#data_Draft_txt' + target_id_additional).val());
    
    // Secondly, set Show/Hide
    $('#data_Tunnel_label' + target_id_additional).show();
    $('#data_Tunnel_txt_div' + target_id_additional).hide();
    $('#data_Belt_label' + target_id_additional).show();
    $('#data_Belt_txt' + target_id_additional).hide();
    $('#data_Draft_label' + target_id_additional).show();
    $('#data_Draft_txt' + target_id_additional).hide();
}

function processParameters__Cargo_Loaded(){
    var data_Confirmed = '';
    var data_Confirmed_Separator = '';
    var data_Deleted = '';
    var data_Deleted_Separator = '';
    
    try{
        var recordId = null;
        var tunnel = '';
        var belt = '';
        var draft = '';
        
        $.each(object_id_Created__Cargo_Loaded, function(i, val){
            recordId = $('#data_RecordId__Cargo_Loaded' + val).val();
            if (recordId == null || recordId == '' || recordId == '-1'){
                recordId = '-1';
            }
            
            if (object_id_Deleted__Cargo_Loaded.indexOf(val) !== -1){
                // this Row will be Deleted
                data_Deleted += data_Deleted_Separator + recordId;
                data_Deleted_Separator = ',';
            }else if($('#data_Confirm__Cargo_Loaded' + val).val() == '1'){
                tunnel = $('#data_Tunnel_id__Cargo_Loaded' + val).val();
                belt = $('#data_Belt_txt__Cargo_Loaded' + val).val();
                draft = $('#data_Draft_txt__Cargo_Loaded' + val).val();
                
                data_Confirmed += data_Confirmed_Separator +
                                        recordId +
                                        'xxx' + tunnel +
                                        'xxx' + belt +
                                        'xxx' + draft
                                        ;
                
                data_Confirmed_Separator = '###';
            }
        });
    }catch(err){}
    
    return data_Confirmed + '+++' + data_Deleted;
}

function isValid__Cargo_Loaded(){
    var result = true;
    var tunnel_Names = [];
    
    detail_Message = '';
    
    try{
        var recordId = null;
        var tunnel = '';
        var belt = '';
        var draft = '';
        
        $.each(object_id_Created__Cargo_Loaded, function(i, val){
            
            if (object_id_Deleted__Cargo_Loaded.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__Cargo_Loaded' + val).val() == '0'
                     && $('#data_still_Edited__Cargo_Loaded' + val).val() == '1'){
            
                result = false;
            }
        });
        
        if ( ! result){
            detail_Message = 'There is data Cargo Loaded still in editing, but not Confirm/Cancel';
            return result;
        }
        
        $.each(object_id_Created__Cargo_Loaded, function(i, val){
            
            if (object_id_Deleted__Cargo_Loaded.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__Cargo_Loaded' + val).val() == '1'){
            
                tunnel = $('#data_Tunnel_id__Cargo_Loaded' + val).val();
                
                if ( ! Is_Valid_Numeric('#data_Belt_txt__Cargo_Loaded' + val)){
                    detail_Message = '[CARGO LOADED] Belt must Valid Numeric value!';
                    result = false;
                    return result;
                }
                
                if ( ! Is_Valid_Numeric('#data_Draft_txt__Cargo_Loaded' + val)){
                    detail_Message = '[CARGO LOADED] Draft must Valid Numeric value!';
                    result = false;
                    return result;
                }
                
                if (tunnel_Names.indexOf(tunnel) !== -1){
                    detail_Message = '[CARGO LOADED] Data is not valid (duplicate Tunnel Name)';
                    result = false;
                    return result;
                }
                
                // save to Array
                tunnel_Names.push(tunnel);
                
            }else if($('#data_Confirm__Cargo_Loaded' + val).val() == '0'){
            
                tunnel = $('#data_Tunnel_id__Cargo_Loaded' + val).val();
                
                // save to Array
                tunnel_Names.push(tunnel);
            }
        });
        
    }catch(err){}
    
    return result;
}

var Ref_Tunnels = [];

function Create_ddl__Cargo_Loaded_Tunnel(p_id) {
    $(p_id).select2({
        placeholder: 'Select'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
        , data:Ref_Tunnels
    });
}

var obj_html_Table__FUEL_CONSUMPTION;
var str_name_Table__FUEL_CONSUMPTION = '#mercyTable__FUEL_CONSUMPTION';

var lineNumber_Data__FUEL_CONSUMPTION = 0;
var object_Created_Count__FUEL_CONSUMPTION = 0;
var object_id_additional__FUEL_CONSUMPTION = ''; // pattern is: '_' + object_Created_Count + '_' + lineNumber_Data;
var object_id_Created__FUEL_CONSUMPTION = [];
var object_id_Deleted__FUEL_CONSUMPTION = [];

function Create_Table__FUEL_CONSUMPTION(){

    Clear_DataGrid_(str_name_Table__FUEL_CONSUMPTION);
    
    try {
        obj_html_Table__FUEL_CONSUMPTION = $(str_name_Table__FUEL_CONSUMPTION).DataTable({
            "bAutoWidth": false
            , "bFilter": false
            , "dom": '<"top">rt<"bottom"iflp><"clear">'
            , "scrollX": true
            , "scrollY": false //"200px"
            //, "scrollCollapse": true
            , "paging": false
            //, "ordering": false
            , "columns": [
                { "data": "RecordId", "name": "RecordId", "autoWidth": true }
                , {
                    render: function (data, type, full, meta){
                        return lineNumber_Data__FUEL_CONSUMPTION;
                    }
                    , visible: false
                }
                , {
                    render: function (data, type, full, meta) {
                        return '<div style="width:50px !important;">'+
                                '<input type="hidden" id="data_RecordId__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" value="' + full.RecordId + '"/>' +
                                '<input type="hidden" id="data_still_Edited__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" value="0"/>' +
                                '<input type="hidden" id="data_Confirm__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" value="0"/>' +
                                '<i id="data_link_Edit__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" onclick="javascript:processLink_Edit__FUEL_CONSUMPTION(this)" class="fa fa-edit" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'display:none;':'') + '" title="Edit"></i>' +
                                '<i id="data_link_Delete__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" onclick="javascript:processLink_Delete__FUEL_CONSUMPTION(this)" class="fa fa-trash" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'display:none;':'') + '" title="Delete"></i>' +
                                '<i id="data_link_Confirm__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" onclick="javascript:processLink_Confirm__FUEL_CONSUMPTION(this)" class="fa fa-check" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'':'display:none;') + '" title="Confirm"></i>' +
                                '<i id="data_link_Cancel__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" onclick="javascript:processLink_Cancel__FUEL_CONSUMPTION(this)" class="fa fa-times" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'':'display:none;') + '" title="Cancel"></i>'
                                '</div>'
                                ;
                    }
                    , className: "mercy_action_icon"
                    , orderable: false
                    , width: "50px"
                }
                , {
                    "render": function (data, type, full, meta){
                        return (full.RecordId==-1?'':lineNumber_Data__FUEL_CONSUMPTION.toString() + '.');
                    }
                    , className: "mercy_text_right"
                    , orderable: false
                    , width: "20px"
                    , visible: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Rob_label__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '">' + full.Fuel_Rob_Name + '</span>' +
                               '<input type="hidden" id="data_Rob_id__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" value="' + full.Fuel_Rob_Id + '"/>' +
                               '<div id="data_Rob_txt_div__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" style="width:100%;' + (full.RecordId==-1?'':'display:none;') + '">' +
                               '<select id="data_Rob_txt__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;"></select>'
                               '</div>'
                               ;
                    }
                    , width: "150px"
                    , orderable: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Liter_label__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '">' + full.Total_Consumption + '</span>' +
                               '<input type="text" id="data_Liter_txt__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION + '" class="shadow-none mercy_text_101" value="" ' + ' style="width:60px;' + (full.RecordId==-1?'':'display:none;') + '"/>'
                               ;
                    }
                    , orderable: false
                }
            ]
            , "columnDefs": [
                {
                    "targets": [0],
                    "visible": false,
                    "searchable": false
                }
            ]
            //, "order": [[3, 'desc'], [4, 'asc']]
            , "order": [[1, 'asc']]
        });

        obj_html_Table__FUEL_CONSUMPTION.on('draw', function () {});
        
        // Resize Table: because this DataTable is newly created
        //resize_Table();
        $("#mercyTable__FUEL_CONSUMPTION_wrapper").width('100%');
    }catch(err){}
}

function Populate_DataGrid__FUEL_CONSUMPTION(p_data){
    Create_Table__FUEL_CONSUMPTION();
    
    // reset
    lineNumber_Data__FUEL_CONSUMPTION = 0;
    object_id_Created__FUEL_CONSUMPTION = [];
    object_id_Deleted__FUEL_CONSUMPTION = [];
    
    try{
        p_data.forEach(
            function (item){
                object_Created_Count__FUEL_CONSUMPTION++;
                lineNumber_Data__FUEL_CONSUMPTION++;
                object_id_additional__FUEL_CONSUMPTION = '_' + object_Created_Count__FUEL_CONSUMPTION.toString() + '_' + lineNumber_Data__FUEL_CONSUMPTION.toString();
                
                // save to Array
                object_id_Created__FUEL_CONSUMPTION.push(object_id_additional__FUEL_CONSUMPTION);
                
                // add to Table
                obj_html_Table__FUEL_CONSUMPTION.row.add(item).draw(false);
                
                var target_id_additional = '__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION;
    
                Create_ddl__FUEL_CONSUMPTION_Rob('#data_Rob_txt' + target_id_additional.toString());
            }
        );
    }catch(err){}
}

function processLink_Add__FUEL_CONSUMPTION(){
    if ( ! is_Editable) return;
    
    // create "Record_Item"
    var item = {CreatedOn_Str:'', CreatedOn_Str2:'', FullName:''
                    // flag for "New Record"
                    , RecordId:-1
                    , Fuel_Rob_Id:-1, Fuel_Rob_Name: '', Total_Consumption:0
                    , CreatedBy: 0, CreatedOn : null
                    , LastModifiedBy : 0, LastModifiedOn : null}
    
    // do "Counting"
    object_Created_Count__FUEL_CONSUMPTION++;
    lineNumber_Data__FUEL_CONSUMPTION++;
    object_id_additional__FUEL_CONSUMPTION = '_' + object_Created_Count__FUEL_CONSUMPTION.toString() + '_' + lineNumber_Data__FUEL_CONSUMPTION.toString();
    
    // save to Array
    object_id_Created__FUEL_CONSUMPTION.push(object_id_additional__FUEL_CONSUMPTION);
    
    // add to Table
    obj_html_Table__FUEL_CONSUMPTION.row.add(item).draw(false);
    
    var target_id_additional = '__FUEL_CONSUMPTION' + object_id_additional__FUEL_CONSUMPTION;
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    Create_ddl__FUEL_CONSUMPTION_Rob('#data_Rob_txt' + target_id_additional.toString());
    
    // Firstly, copy data
    //$('#data_Rob_txt' + target_id_additional).val($('#data_Rob_id' + target_id_additional).val()).trigger('change');
    $('#data_Liter_txt' + target_id_additional).val($('#data_Liter_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_Rob_label' + target_id_additional).hide();
    $('#data_Rob_txt_div' + target_id_additional).show();
    $('#data_Liter_label' + target_id_additional).hide();
    $('#data_Liter_txt' + target_id_additional).show();
}

function processLink_Edit__FUEL_CONSUMPTION(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Edit', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).hide();
    $('#data_link_Delete' + target_id_additional).hide();
    $('#data_link_Confirm' + target_id_additional).show();
    $('#data_link_Cancel' + target_id_additional).show();
    
    // Firstly, copy data
    $('#data_Rob_txt' + target_id_additional).val($('#data_Rob_id' + target_id_additional).val()).trigger('change');
    $('#data_Liter_txt' + target_id_additional).val($('#data_Liter_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_Rob_label' + target_id_additional).hide();
    $('#data_Rob_txt_div' + target_id_additional).show();
    $('#data_Liter_label' + target_id_additional).hide();
    $('#data_Liter_txt' + target_id_additional).show();
}

function processLink_Cancel__FUEL_CONSUMPTION(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Cancel', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // set Show/Hide
    $('#data_Rob_label' + target_id_additional).show();
    $('#data_Rob_txt_div' + target_id_additional).hide();
    $('#data_Liter_label' + target_id_additional).show();
    $('#data_Liter_txt' + target_id_additional).hide();
    
    var recordId = $('#data_RecordId' + target_id_additional).val();
    if (recordId == '-1'){
        // this action = 'Create';
    }else{
        // this action = 'Edit';
        return;
    }
    
    try {
        var lineFound = -1;
        var line = 0;
        $.each(object_id_Created__FUEL_CONSUMPTION, function( i, val ){
            line++;
            if ('__FUEL_CONSUMPTION' + val == target_id_additional)
            {
                lineFound = line;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__FUEL_CONSUMPTION + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
        }
    }catch(err){}
}

function processLink_Delete__FUEL_CONSUMPTION(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Delete', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    /*if (lineNumber_Data<=1){
        alert('Data is only 1. Please do not delete it!');
        return;
    }
    if (lineNumber_Data<= (object_id_Deleted.length+1)){
        alert('Enough for Delete!');
        return;
    }*/
    
    try {
        var lineFound = -1;
        var line = 0;
        var id_deleted = '';
        
        $.each(object_id_Created__FUEL_CONSUMPTION, function( i, val ){
            line++;
            if ('__FUEL_CONSUMPTION' + val == target_id_additional)
            {
                lineFound = line;
                id_deleted = val;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__FUEL_CONSUMPTION + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
            
            // save to Array
            object_id_Deleted__FUEL_CONSUMPTION.push(id_deleted);
        }
    }catch(err){}
}

function processLink_Confirm__FUEL_CONSUMPTION(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Confirm', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('1');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // Firstly, copy data
    var Rob_value = $('#data_Rob_txt' + target_id_additional).select2('data');
    var Rob = Rob_value[0];
    
    $('#data_Rob_label' + target_id_additional).text(Rob.text);
    $('#data_Rob_id' + target_id_additional).val(Rob.id);
    $('#data_Liter_label' + target_id_additional).text($('#data_Liter_txt' + target_id_additional).val());
    
    // Secondly, set Show/Hide
    $('#data_Rob_label' + target_id_additional).show();
    $('#data_Rob_txt_div' + target_id_additional).hide();
    $('#data_Liter_label' + target_id_additional).show();
    $('#data_Liter_txt' + target_id_additional).hide();
}

function processParameters__FUEL_CONSUMPTION(){
    var data_Confirmed = '';
    var data_Confirmed_Separator = '';
    var data_Deleted = '';
    var data_Deleted_Separator = '';
    
    try{
        var recordId = null;
        var Rob = '';
        var Liter = '';
        
        $.each(object_id_Created__FUEL_CONSUMPTION, function(i, val){
            recordId = $('#data_RecordId__FUEL_CONSUMPTION' + val).val();
            if (recordId == null || recordId == '' || recordId == '-1'){
                recordId = '-1';
            }
            
            if (object_id_Deleted__FUEL_CONSUMPTION.indexOf(val) !== -1){
                // this Row will be Deleted
                data_Deleted += data_Deleted_Separator + recordId;
                data_Deleted_Separator = ',';
            }else if($('#data_Confirm__FUEL_CONSUMPTION' + val).val() == '1'){
                Rob = $('#data_Rob_id__FUEL_CONSUMPTION' + val).val();
                Liter = $('#data_Liter_txt__FUEL_CONSUMPTION' + val).val();
                
                data_Confirmed += data_Confirmed_Separator +
                                        recordId +
                                        'xxx' + Rob +
                                        'xxx' + Liter
                                        ;
                
                data_Confirmed_Separator = '###';
            }
        });
    }catch(err){}
    
    return data_Confirmed + '+++' + data_Deleted;
}

function isValid__FUEL_CONSUMPTION(){
    var result = true;
    var rob_Names = [];
    
    detail_Message = '';
    
    try{
        var recordId = null;
        var Rob = '';
        var Liter = '';
        
        $.each(object_id_Created__FUEL_CONSUMPTION, function(i, val){
            
            if (object_id_Deleted__FUEL_CONSUMPTION.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__FUEL_CONSUMPTION' + val).val() == '0'
                     && $('#data_still_Edited__FUEL_CONSUMPTION' + val).val() == '1'){
            
                result = false;
            }
        });
        
        if ( ! result){
            detail_Message = 'There is data Fuel Consumption still in editing, but not Confirm/Cancel';
            return result;
        }
        
        $.each(object_id_Created__FUEL_CONSUMPTION, function(i, val){
            
            if (object_id_Deleted__FUEL_CONSUMPTION.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__FUEL_CONSUMPTION' + val).val() == '1'){
            
                Rob = $('#data_Rob_id__FUEL_CONSUMPTION' + val).val();
                
                if ( ! Is_Valid_Numeric('#data_Liter_txt__FUEL_CONSUMPTION' + val)){
                    detail_Message = '[FUEL CONSUMPTION] Liter must Valid Numeric value!';
                    result = false;
                    return result;
                }
                
                if (rob_Names.indexOf(Rob) !== -1){
                    detail_Message = '[FUEL CONSUMPTION] Data is not valid (number is not valid)';
                    result = false;
                    return result;
                }
                
                // save to Array
                rob_Names.push(Rob);
            
            }else if($('#data_Confirm__FUEL_CONSUMPTION' + val).val() == '0'){
            
                Rob = $('#data_Rob_id__FUEL_CONSUMPTION' + val).val();
                
                // save to Array
                rob_Names.push(Rob);
            }
        });
        
    }catch(err){}
    
    return result;
}

var Ref_Fuel_Rob = [];

function Create_ddl__FUEL_CONSUMPTION_Rob(p_id) {
    $(p_id).select2({
        placeholder: 'Select'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
        , data:Ref_Fuel_Rob
    });
}

var obj_html_Table__DRAFT_SURVEY;
var str_name_Table__DRAFT_SURVEY = '#mercyTable__DRAFT_SURVEY';

var lineNumber_Data__DRAFT_SURVEY = 0;
var object_Created_Count__DRAFT_SURVEY = 0;
var object_id_additional__DRAFT_SURVEY = ''; // pattern is: '_' + object_Created_Count + '_' + lineNumber_Data;
var object_id_Created__DRAFT_SURVEY = [];
var object_id_Deleted__DRAFT_SURVEY = [];

function Create_Table__DRAFT_SURVEY(){

    Clear_DataGrid_(str_name_Table__DRAFT_SURVEY);
    
    try {
        obj_html_Table__DRAFT_SURVEY = $(str_name_Table__DRAFT_SURVEY).DataTable({
            "bAutoWidth": false
            , "bFilter": false
            , "dom": '<"top">rt<"bottom"iflp><"clear">'
            , "scrollX": true
            , "scrollY": false //"200px"
            //, "scrollCollapse": true
            , "paging": false
            //, "ordering": false
            , "columns": [
                { "data": "RecordId", "name": "RecordId", "autoWidth": true }
                , {
                    render: function (data, type, full, meta){
                        return lineNumber_Data__DRAFT_SURVEY;
                    }
                    , visible: false
                }
                , {
                    render: function (data, type, full, meta) {
                        return '<div style="width:50px !important;">'+
                                '<input type="hidden" id="data_RecordId__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" value="' + full.RecordId + '"/>' +
                                '<input type="hidden" id="data_still_Edited__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" value="0"/>' +
                                '<input type="hidden" id="data_Confirm__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" value="0"/>' +
                                '<i id="data_link_Edit__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" onclick="javascript:processLink_Edit__DRAFT_SURVEY(this)" class="fa fa-edit" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'display:none;':'') + '" title="Edit"></i>' +
                                '<i id="data_link_Delete__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" onclick="javascript:processLink_Delete__DRAFT_SURVEY(this)" class="fa fa-trash" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'display:none;':'') + '" title="Delete"></i>' +
                                '<i id="data_link_Confirm__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" onclick="javascript:processLink_Confirm__DRAFT_SURVEY(this)" class="fa fa-check" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'':'display:none;') + '" title="Confirm"></i>' +
                                '<i id="data_link_Cancel__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" onclick="javascript:processLink_Cancel__DRAFT_SURVEY(this)" class="fa fa-times" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'':'display:none;') + '" title="Cancel"></i>'
                                '</div>'
                                ;
                    }
                    , className: "mercy_action_icon"
                    , orderable: false
                    , width: "50px"
                }
                , {
                    "render": function (data, type, full, meta){
                        return (full.RecordId==-1?'':lineNumber_Data__DRAFT_SURVEY.toString() + '.');
                    }
                    , className: "mercy_text_right"
                    , orderable: false
                    , width: "20px"
                    , visible: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Draft_Survey_label__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '">' + full.Draft_Survey_Name + '</span>' +
                               '<input type="hidden" id="data_Draft_Survey_id__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" value="' + full.Draft_Survey_Id + '"/>' +
                               '<div id="data_Draft_Survey_txt_div__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" style="width:100%;' + (full.RecordId==-1?'':'display:none;') + '">' +
                               '<select id="data_Draft_Survey_txt__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;"></select>'
                               '</div>'
                               ;
                    }
                    , width: "140px"
                    , orderable: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Initial_label__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '">' + full.Initial + '</span>' +
                               '<input type="text" id="data_Initial_txt__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" class="shadow-none mercy_text_101" value="" ' + ' style="width:100%;' + (full.RecordId==-1?'':'display:none;') + '"/>'
                               ;
                    }
                    , width: "60px"
                    , orderable: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Final_label__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '">' + full.Final + '</span>' +
                               '<input type="text" id="data_Final_txt__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY + '" class="shadow-none mercy_text_101" value="" ' + ' style="width:60px;' + (full.RecordId==-1?'':'display:none;') + '"/>'
                               ;
                    }
                    , orderable: false
                }
            ]
            , "columnDefs": [
                {
                    "targets": [0],
                    "visible": false,
                    "searchable": false
                }
            ]
            //, "order": [[3, 'desc'], [4, 'asc']]
            , "order": [[1, 'asc']]
        });

        obj_html_Table__DRAFT_SURVEY.on('draw', function () {});
        
        // Resize Table: because this DataTable is newly created
        //resize_Table();
        $("#mercyTable__DRAFT_SURVEY_wrapper").width('100%');
    }catch(err){}
}

function Populate_DataGrid__DRAFT_SURVEY(p_data){
    Create_Table__DRAFT_SURVEY();
    
    // reset
    lineNumber_Data__DRAFT_SURVEY = 0;
    object_id_Created__DRAFT_SURVEY = [];
    object_id_Deleted__DRAFT_SURVEY = [];
    
    try{
        p_data.forEach(
            function (item){
                object_Created_Count__DRAFT_SURVEY++;
                lineNumber_Data__DRAFT_SURVEY++;
                object_id_additional__DRAFT_SURVEY = '_' + object_Created_Count__DRAFT_SURVEY.toString() + '_' + lineNumber_Data__DRAFT_SURVEY.toString();
                
                // save to Array
                object_id_Created__DRAFT_SURVEY.push(object_id_additional__DRAFT_SURVEY);
                
                // add to Table
                obj_html_Table__DRAFT_SURVEY.row.add(item).draw(false);
                
                var target_id_additional = '__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY;
    
                Create_ddl__DRAFT_SURVEY_Draft_Survey('#data_Draft_Survey_txt' + target_id_additional.toString());
            }
        );
    }catch(err){}
}

function processLink_Add__DRAFT_SURVEY(){
    if ( ! is_Editable) return;
    
    // create "Record_Item"
    var item = {CreatedOn_Str:'', CreatedOn_Str2:'', FullName:''
                    // flag for "New Record"
                    , RecordId:-1
                    , Draft_Survey_Id:-1, Draft_Survey_Name: '', Initial:0, Final:0
                    , CreatedBy: 0, CreatedOn : null
                    , LastModifiedBy : 0, LastModifiedOn : null}
    
    // do "Counting"
    object_Created_Count__DRAFT_SURVEY++;
    lineNumber_Data__DRAFT_SURVEY++;
    object_id_additional__DRAFT_SURVEY = '_' + object_Created_Count__DRAFT_SURVEY.toString() + '_' + lineNumber_Data__DRAFT_SURVEY.toString();
    
    // save to Array
    object_id_Created__DRAFT_SURVEY.push(object_id_additional__DRAFT_SURVEY);
    
    // add to Table
    obj_html_Table__DRAFT_SURVEY.row.add(item).draw(false);
    
    var target_id_additional = '__DRAFT_SURVEY' + object_id_additional__DRAFT_SURVEY;
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    Create_ddl__DRAFT_SURVEY_Draft_Survey('#data_Draft_Survey_txt' + target_id_additional.toString());
    
    // Firstly, copy data
    //$('#data_Draft_Survey_txt' + target_id_additional).val($('#data_Draft_Survey_id' + target_id_additional).val()).trigger('change');
    $('#data_Initial_txt' + target_id_additional).val($('#data_Initial_label' + target_id_additional).text());
    $('#data_Final_txt' + target_id_additional).val($('#data_Final_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_Draft_Survey_label' + target_id_additional).hide();
    $('#data_Draft_Survey_txt_div' + target_id_additional).show();
    $('#data_Initial_label' + target_id_additional).hide();
    $('#data_Initial_txt' + target_id_additional).show();
    $('#data_Final_label' + target_id_additional).hide();
    $('#data_Final_txt' + target_id_additional).show();
}

function processLink_Edit__DRAFT_SURVEY(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Edit', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).hide();
    $('#data_link_Delete' + target_id_additional).hide();
    $('#data_link_Confirm' + target_id_additional).show();
    $('#data_link_Cancel' + target_id_additional).show();
    
    // Firstly, copy data
    $('#data_Draft_Survey_txt' + target_id_additional).val($('#data_Draft_Survey_id' + target_id_additional).val()).trigger('change');
    $('#data_Initial_txt' + target_id_additional).val($('#data_Initial_label' + target_id_additional).text());
    $('#data_Final_txt' + target_id_additional).val($('#data_Final_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_Draft_Survey_label' + target_id_additional).hide();
    $('#data_Draft_Survey_txt_div' + target_id_additional).show();
    $('#data_Initial_label' + target_id_additional).hide();
    $('#data_Initial_txt' + target_id_additional).show();
    $('#data_Final_label' + target_id_additional).hide();
    $('#data_Final_txt' + target_id_additional).show();
}

function processLink_Cancel__DRAFT_SURVEY(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Cancel', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // set Show/Hide
    $('#data_Draft_Survey_label' + target_id_additional).show();
    $('#data_Draft_Survey_txt_div' + target_id_additional).hide();
    $('#data_Initial_label' + target_id_additional).show();
    $('#data_Initial_txt' + target_id_additional).hide();
    $('#data_Final_label' + target_id_additional).show();
    $('#data_Final_txt' + target_id_additional).hide();
    
    var recordId = $('#data_RecordId' + target_id_additional).val();
    if (recordId == '-1'){
        // this action = 'Create';
    }else{
        // this action = 'Edit';
        return;
    }
    
    try {
        var lineFound = -1;
        var line = 0;
        $.each(object_id_Created__DRAFT_SURVEY, function( i, val ){
            line++;
            if ('__DRAFT_SURVEY' + val == target_id_additional)
            {
                lineFound = line;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__DRAFT_SURVEY + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
        }
    }catch(err){}
}

function processLink_Delete__DRAFT_SURVEY(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Delete', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    /*if (lineNumber_Data<=1){
        alert('Data is only 1. Please do not delete it!');
        return;
    }
    if (lineNumber_Data<= (object_id_Deleted.length+1)){
        alert('Enough for Delete!');
        return;
    }*/
    
    try {
        var lineFound = -1;
        var line = 0;
        var id_deleted = '';
        
        $.each(object_id_Created__DRAFT_SURVEY, function( i, val ){
            line++;
            if ('__DRAFT_SURVEY' + val == target_id_additional)
            {
                lineFound = line;
                id_deleted = val;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__DRAFT_SURVEY + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
            
            // save to Array
            object_id_Deleted__DRAFT_SURVEY.push(id_deleted);
        }
    }catch(err){}
}

function processLink_Confirm__DRAFT_SURVEY(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Confirm', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('1');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // Firstly, copy data
    var Draft_Survey_value = $('#data_Draft_Survey_txt' + target_id_additional).select2('data');
    var Draft_Survey = Draft_Survey_value[0];
    
    $('#data_Draft_Survey_label' + target_id_additional).text(Draft_Survey.text);
    $('#data_Draft_Survey_id' + target_id_additional).val(Draft_Survey.id);
    $('#data_Initial_label' + target_id_additional).text($('#data_Initial_txt' + target_id_additional).val());
    $('#data_Final_label' + target_id_additional).text($('#data_Final_txt' + target_id_additional).val());
    
    // Secondly, set Show/Hide
    $('#data_Draft_Survey_label' + target_id_additional).show();
    $('#data_Draft_Survey_txt_div' + target_id_additional).hide();
    $('#data_Initial_label' + target_id_additional).show();
    $('#data_Initial_txt' + target_id_additional).hide();
    $('#data_Final_label' + target_id_additional).show();
    $('#data_Final_txt' + target_id_additional).hide();
}

function processParameters__DRAFT_SURVEY(){
    var data_Confirmed = '';
    var data_Confirmed_Separator = '';
    var data_Deleted = '';
    var data_Deleted_Separator = '';
    
    try{
        var recordId = null;
        var Draft_Survey = '';
        var Initial = '';
        var Final = '';
        
        $.each(object_id_Created__DRAFT_SURVEY, function(i, val){
            recordId = $('#data_RecordId__DRAFT_SURVEY' + val).val();
            if (recordId == null || recordId == '' || recordId == '-1'){
                recordId = '-1';
            }
            
            if (object_id_Deleted__DRAFT_SURVEY.indexOf(val) !== -1){
                // this Row will be Deleted
                data_Deleted += data_Deleted_Separator + recordId;
                data_Deleted_Separator = ',';
            }else if($('#data_Confirm__DRAFT_SURVEY' + val).val() == '1'){
                Draft_Survey = $('#data_Draft_Survey_id__DRAFT_SURVEY' + val).val();
                Initial = $('#data_Initial_txt__DRAFT_SURVEY' + val).val();
                Final = $('#data_Final_txt__DRAFT_SURVEY' + val).val();
                
                data_Confirmed += data_Confirmed_Separator +
                                        recordId +
                                        'xxx' + Draft_Survey +
                                        'xxx' + Initial +
                                        'xxx' + Final
                                        ;
                
                data_Confirmed_Separator = '###';
            }
        });
    }catch(err){}
    
    return data_Confirmed + '+++' + data_Deleted;
}

function isValid__DRAFT_SURVEY(){
    var result = true;
    var draft_Names = [];
    
    detail_Message = '';
    
    try{
        var recordId = null;
        var Draft_Survey = '';
        var Initial = '';
        var Final = '';
        
        $.each(object_id_Created__DRAFT_SURVEY, function(i, val){
            
            if (object_id_Deleted__DRAFT_SURVEY.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__DRAFT_SURVEY' + val).val() == '0'
                     && $('#data_still_Edited__DRAFT_SURVEY' + val).val() == '1'){
            
                result = false;
            }
        });
        
        if ( ! result){
            detail_Message = 'There is data Draft Survey still in editing, but not Confirm/Cancel';
            return result;
        }
        
        $.each(object_id_Created__DRAFT_SURVEY, function(i, val){
            
            if (object_id_Deleted__DRAFT_SURVEY.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__DRAFT_SURVEY' + val).val() == '1'){
            
                Draft_Survey = $('#data_Draft_Survey_id__DRAFT_SURVEY' + val).val();
                
                if ( ! Is_Valid_Numeric('#data_Initial_txt__DRAFT_SURVEY' + val)){
                    detail_Message = '[DRAFT SURVEY] Initial must Valid Numeric value!';
                    result = false;
                    return result;
                }
                
                if ( ! Is_Valid_Numeric('#data_Final_txt__DRAFT_SURVEY' + val)){
                    detail_Message = '[DRAFT SURVEY] Final must Valid Numeric value!';
                    result = false;
                    return result;
                }
                
                if (draft_Names.indexOf(Draft_Survey) !== -1){
                    detail_Message = '[DRAFT SURVEY] Data is not valid (duplicate Draft Survey Record Name)';
                    result = false;
                    return result;
                }
                
                // save to Array
                draft_Names.push(Draft_Survey);
                
            }else if($('#data_Confirm__DRAFT_SURVEY' + val).val() == '0'){
            
                Draft_Survey = $('#data_Draft_Survey_id__DRAFT_SURVEY' + val).val();
                
                // save to Array
                draft_Names.push(Draft_Survey);
            }
        });
        
    }catch(err){}
    
    return result;
}

var Ref_Draft_Survey = [];

function Create_ddl__DRAFT_SURVEY_Draft_Survey(p_id) {
    $(p_id).select2({
        placeholder: 'Select'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
        , data:Ref_Draft_Survey
    });
}

var obj_html_Table__BARGE_SURVEY;
var str_name_Table__BARGE_SURVEY = '#mercyTable__BARGE_SURVEY';

var lineNumber_Data__BARGE_SURVEY = 0;
var object_Created_Count__BARGE_SURVEY = 0;
var object_id_additional__BARGE_SURVEY = ''; // pattern is: '_' + object_Created_Count + '_' + lineNumber_Data;
var object_id_Created__BARGE_SURVEY = [];
var object_id_Deleted__BARGE_SURVEY = [];

function Create_Table__BARGE_SURVEY(){

    Clear_DataGrid_(str_name_Table__BARGE_SURVEY);
    
    try {
        obj_html_Table__BARGE_SURVEY = $(str_name_Table__BARGE_SURVEY).DataTable({
            "bAutoWidth": false
            , "bFilter": false
            , "dom": '<"top">rt<"bottom"iflp><"clear">'
            , "scrollX": true
            , "scrollY": false //"200px"
            //, "scrollCollapse": true
            , "paging": false
            //, "ordering": false
            , "columns": [
                { "data": "RecordId", "name": "RecordId", "autoWidth": true }
                , {
                    render: function (data, type, full, meta){
                        return lineNumber_Data__BARGE_SURVEY;
                    }
                    , visible: false
                }
                , {
                    render: function (data, type, full, meta) {
                        return '<div style="width:50px !important;">'+
                                '<input type="hidden" id="data_RecordId__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" value="' + full.RecordId + '"/>' +
                                '<input type="hidden" id="data_still_Edited__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" value="0"/>' +
                                '<input type="hidden" id="data_Confirm__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" value="0"/>' +
                                '<i id="data_link_Edit__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" onclick="javascript:processLink_Edit__BARGE_SURVEY(this)" class="fa fa-edit" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'display:none;':'') + '" title="Edit"></i>' +
                                '<i id="data_link_Delete__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" onclick="javascript:processLink_Delete__BARGE_SURVEY(this)" class="fa fa-trash" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'display:none;':'') + '" title="Delete"></i>' +
                                '<i id="data_link_Confirm__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" onclick="javascript:processLink_Confirm__BARGE_SURVEY(this)" class="fa fa-check" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'':'display:none;') + '" title="Confirm"></i>' +
                                '<i id="data_link_Cancel__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" onclick="javascript:processLink_Cancel__BARGE_SURVEY(this)" class="fa fa-times" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'':'display:none;') + '" title="Cancel"></i>'
                                '</div>'
                                ;
                    }
                    , className: "mercy_action_icon"
                    , orderable: false
                    , width: "50px"
                }
                , {
                    "render": function (data, type, full, meta){
                        return (full.RecordId==-1?'':lineNumber_Data__BARGE_SURVEY.toString() + '.');
                    }
                    , className: "mercy_text_right"
                    , orderable: false
                    , width: "20px"
                    , visible: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Ddl_label__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '">' + full.Barge_Survey_Name + '</span>' +
                               '<input type="hidden" id="data_Ddl_id__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" value="' + full.Barge_Survey_Condition_Id + '"/>' +
                               '<div id="data_Ddl_txt_div__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" style="width:100%;' + (full.RecordId==-1?'':'display:none;') + '">' +
                               '<select id="data_Ddl_txt__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;"></select>'
                               '</div>'
                               ;
                    }
                    , width: "180px"
                    , orderable: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Condition_label__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '">' + full.Condition + '</span>' +
                               '<input type="text" id="data_Condition_txt__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" class="shadow-none mercy_text_101" value="" ' + ' style="width:100%;' + (full.RecordId==-1?'':'display:none;') + '"/>'
                               ;
                    }
                    , width: "80px"
                    , orderable: false
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Remark_label__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '">' + full.Remark + '</span>' +
                               '<input type="text" id="data_Remark_txt__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY + '" class="shadow-none mercy_text_101" value="" ' + ' style="width:250px;' + (full.RecordId==-1?'':'display:none;') + '"/>'
                               ;
                    }
                    , orderable: false
                }
            ]
            , "columnDefs": [
                {
                    "targets": [0],
                    "visible": false,
                    "searchable": false
                }
            ]
            //, "order": [[3, 'desc'], [4, 'asc']]
            , "order": [[1, 'asc']]
        });

        obj_html_Table__BARGE_SURVEY.on('draw', function () {});
        
        // Resize Table: because this DataTable is newly created
        //resize_Table();
        $("#mercyTable__BARGE_SURVEY_wrapper").width('100%');
    }catch(err){}
}

function Populate_DataGrid__BARGE_SURVEY(p_data){
    Create_Table__BARGE_SURVEY();
    
    // reset
    lineNumber_Data__BARGE_SURVEY = 0;
    object_id_Created__BARGE_SURVEY = [];
    object_id_Deleted__BARGE_SURVEY = [];
    
    try{
        p_data.forEach(
            function (item){
                object_Created_Count__BARGE_SURVEY++;
                lineNumber_Data__BARGE_SURVEY++;
                object_id_additional__BARGE_SURVEY = '_' + object_Created_Count__BARGE_SURVEY.toString() + '_' + lineNumber_Data__BARGE_SURVEY.toString();
                
                // save to Array
                object_id_Created__BARGE_SURVEY.push(object_id_additional__BARGE_SURVEY);
                
                // add to Table
                obj_html_Table__BARGE_SURVEY.row.add(item).draw(false);
                
                var target_id_additional = '__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY;
    
                Create_ddl__BARGE_SURVEY_Ddl('#data_Ddl_txt' + target_id_additional.toString());
            }
        );
    }catch(err){}
}

function processLink_Add__BARGE_SURVEY(){
    if ( ! is_Editable) return;
    
    // create "Record_Item"
    var item = {CreatedOn_Str:'', CreatedOn_Str2:'', FullName:''
                    // flag for "New Record"
                    , RecordId:-1
                    , Barge_Survey_Condition_Id:-1, Barge_Survey_Name: '', Condition:'', Remark:''
                    , CreatedBy: 0, CreatedOn : null
                    , LastModifiedBy : 0, LastModifiedOn : null}
    
    // do "Counting"
    object_Created_Count__BARGE_SURVEY++;
    lineNumber_Data__BARGE_SURVEY++;
    object_id_additional__BARGE_SURVEY = '_' + object_Created_Count__BARGE_SURVEY.toString() + '_' + lineNumber_Data__BARGE_SURVEY.toString();
    
    // save to Array
    object_id_Created__BARGE_SURVEY.push(object_id_additional__BARGE_SURVEY);
    
    // add to Table
    obj_html_Table__BARGE_SURVEY.row.add(item).draw(false);
    
    var target_id_additional = '__BARGE_SURVEY' + object_id_additional__BARGE_SURVEY;
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    Create_ddl__BARGE_SURVEY_Ddl('#data_Ddl_txt' + target_id_additional.toString());
    
    // Firstly, copy data
    //$('#data_Ddl_txt' + target_id_additional).val($('#data_Ddl_id' + target_id_additional).val()).trigger('change');
    $('#data_Condition_txt' + target_id_additional).val($('#data_Condition_label' + target_id_additional).text());
    $('#data_Remark_txt' + target_id_additional).val($('#data_Remark_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_Ddl_label' + target_id_additional).hide();
    $('#data_Ddl_txt_div' + target_id_additional).show();
    $('#data_Condition_label' + target_id_additional).hide();
    $('#data_Condition_txt' + target_id_additional).show();
    $('#data_Remark_label' + target_id_additional).hide();
    $('#data_Remark_txt' + target_id_additional).show();
}

function processLink_Edit__BARGE_SURVEY(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Edit', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).hide();
    $('#data_link_Delete' + target_id_additional).hide();
    $('#data_link_Confirm' + target_id_additional).show();
    $('#data_link_Cancel' + target_id_additional).show();
    
    // Firstly, copy data
    $('#data_Ddl_txt' + target_id_additional).val($('#data_Ddl_id' + target_id_additional).val()).trigger('change');
    $('#data_Condition_txt' + target_id_additional).val($('#data_Condition_label' + target_id_additional).text());
    $('#data_Remark_txt' + target_id_additional).val($('#data_Remark_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_Ddl_label' + target_id_additional).hide();
    $('#data_Ddl_txt_div' + target_id_additional).show();
    $('#data_Condition_label' + target_id_additional).hide();
    $('#data_Condition_txt' + target_id_additional).show();
    $('#data_Remark_label' + target_id_additional).hide();
    $('#data_Remark_txt' + target_id_additional).show();
}

function processLink_Cancel__BARGE_SURVEY(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Cancel', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // set Show/Hide
    $('#data_Ddl_label' + target_id_additional).show();
    $('#data_Ddl_txt_div' + target_id_additional).hide();
    $('#data_Condition_label' + target_id_additional).show();
    $('#data_Condition_txt' + target_id_additional).hide();
    $('#data_Remark_label' + target_id_additional).show();
    $('#data_Remark_txt' + target_id_additional).hide();
    
    var recordId = $('#data_RecordId' + target_id_additional).val();
    if (recordId == '-1'){
        // this action = 'Create';
    }else{
        // this action = 'Edit';
        return;
    }
    
    try {
        var lineFound = -1;
        var line = 0;
        $.each(object_id_Created__BARGE_SURVEY, function( i, val ){
            line++;
            if ('__BARGE_SURVEY' + val == target_id_additional)
            {
                lineFound = line;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__BARGE_SURVEY + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
        }
    }catch(err){}
}

function processLink_Delete__BARGE_SURVEY(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Delete', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    /*if (lineNumber_Data<=1){
        alert('Data is only 1. Please do not delete it!');
        return;
    }
    if (lineNumber_Data<= (object_id_Deleted.length+1)){
        alert('Enough for Delete!');
        return;
    }*/
    
    try {
        var lineFound = -1;
        var line = 0;
        var id_deleted = '';
        
        $.each(object_id_Created__BARGE_SURVEY, function( i, val ){
            line++;
            if ('__BARGE_SURVEY' + val == target_id_additional)
            {
                lineFound = line;
                id_deleted = val;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__BARGE_SURVEY + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
            
            // save to Array
            object_id_Deleted__BARGE_SURVEY.push(id_deleted);
        }
    }catch(err){}
}

function processLink_Confirm__BARGE_SURVEY(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Confirm', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('1');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // Firstly, copy data
    var Ddl_value = $('#data_Ddl_txt' + target_id_additional).select2('data');
    var Ddl = Ddl_value[0];
    
    $('#data_Ddl_label' + target_id_additional).text(Ddl.text);
    $('#data_Ddl_id' + target_id_additional).val(Ddl.id);
    $('#data_Condition_label' + target_id_additional).text($('#data_Condition_txt' + target_id_additional).val());
    $('#data_Remark_label' + target_id_additional).text($('#data_Remark_txt' + target_id_additional).val());
    
    // Secondly, set Show/Hide
    $('#data_Ddl_label' + target_id_additional).show();
    $('#data_Ddl_txt_div' + target_id_additional).hide();
    $('#data_Condition_label' + target_id_additional).show();
    $('#data_Condition_txt' + target_id_additional).hide();
    $('#data_Remark_label' + target_id_additional).show();
    $('#data_Remark_txt' + target_id_additional).hide();
}

function processParameters__BARGE_SURVEY(){
    var data_Confirmed = '';
    var data_Confirmed_Separator = '';
    var data_Deleted = '';
    var data_Deleted_Separator = '';
    
    try{
        var recordId = null;
        var Ddl = '';
        var Condition = '';
        var Remark = '';
        
        $.each(object_id_Created__BARGE_SURVEY, function(i, val){
            recordId = $('#data_RecordId__BARGE_SURVEY' + val).val();
            if (recordId == null || recordId == '' || recordId == '-1'){
                recordId = '-1';
            }
            
            if (object_id_Deleted__BARGE_SURVEY.indexOf(val) !== -1){
                // this Row will be Deleted
                data_Deleted += data_Deleted_Separator + recordId;
                data_Deleted_Separator = ',';
            }else if($('#data_Confirm__BARGE_SURVEY' + val).val() == '1'){
                Ddl = $('#data_Ddl_id__BARGE_SURVEY' + val).val();
                Condition = $('#data_Condition_txt__BARGE_SURVEY' + val).val();
                Remark = $('#data_Remark_txt__BARGE_SURVEY' + val).val();
                
                data_Confirmed += data_Confirmed_Separator +
                                        recordId +
                                        'xxx' + Ddl +
                                        'xxx' + Condition +
                                        'xxx' + Remark
                                        ;
                
                data_Confirmed_Separator = '###';
            }
        });
    }catch(err){}
    
    return data_Confirmed + '+++' + data_Deleted;
}

function isValid__BARGE_SURVEY(){
    var result = true;
    var survey_Names = [];
    
    detail_Message = '';
    
    try{
        var recordId = null;
        var Ddl = '';
        var Condition = '';
        var Remark = '';
        
        $.each(object_id_Created__BARGE_SURVEY, function(i, val){
            
            if (object_id_Deleted__BARGE_SURVEY.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__BARGE_SURVEY' + val).val() == '0'
                     && $('#data_still_Edited__BARGE_SURVEY' + val).val() == '1'){
            
                result = false;
            }
        });
        
        if ( ! result){
            detail_Message = 'There is data Barge Survey still in editing, but not Confirm/Cancel';
            return result;
        }
        
        $.each(object_id_Created__BARGE_SURVEY, function(i, val){
            
            if (object_id_Deleted__BARGE_SURVEY.indexOf(val) !== -1){
                // this Row will be Deleted
                data_Deleted += data_Deleted_Separator + recordId;
                data_Deleted_Separator = ',';
            }else if($('#data_Confirm__BARGE_SURVEY' + val).val() == '1'){
                Ddl = $('#data_Ddl_id__BARGE_SURVEY' + val).val();
                Condition = $('#data_Condition_txt__BARGE_SURVEY' + val).val();
                Remark = $('#data_Remark_txt__BARGE_SURVEY' + val).val();
                
                if (Condition == ''){
                    detail_Message = '[BARGE_SURVEY] Condition must not be empty';
                    result = false;
                    return result;
                }
                
                if (Remark == ''){
                    detail_Message = '[BARGE_SURVEY] Remark must not be empty';
                    result = false;
                    return result;
                }
                
                if (survey_Names.indexOf(Ddl) !== -1){
                    detail_Message = '[BARGE_SURVEY] Data is not valid (duplicate Barge Survey)';
                    result = false;
                    return result;
                }
                
                // save to Array
                survey_Names.push(Ddl);
                
            }else if($('#data_Confirm__BARGE_SURVEY' + val).val() == '0'){
            
                Ddl = $('#data_Ddl_id__BARGE_SURVEY' + val).val();
                
                // save to Array
                survey_Names.push(Ddl);
            }
        });
    }catch(err){}
    
    return result;
}

var Ref_Barge_Survey_Condition = [];

function Create_ddl__BARGE_SURVEY_Ddl(p_id) {
    $(p_id).select2({
        placeholder: 'Select'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
        , data:Ref_Barge_Survey_Condition
    });
}

var obj_html_Table__COAL_TEMPERATURE;
var str_name_Table__COAL_TEMPERATURE = '#mercyTable__COAL_TEMPERATURE';

var lineNumber_Data__COAL_TEMPERATURE = 0;
var object_Created_Count__COAL_TEMPERATURE = 0;
var object_id_additional__COAL_TEMPERATURE = ''; // pattern is: '_' + object_Created_Count + '_' + lineNumber_Data;
var object_id_Created__COAL_TEMPERATURE = [];
var object_id_Deleted__COAL_TEMPERATURE = [];

function Create_Table__COAL_TEMPERATURE(){

    Clear_DataGrid_(str_name_Table__COAL_TEMPERATURE);
    
    try {
        obj_html_Table__COAL_TEMPERATURE = $(str_name_Table__COAL_TEMPERATURE).DataTable({
            "bAutoWidth": false
            , "bFilter": false
            , "dom": '<"top">rt<"bottom"iflp><"clear">'
            , "scrollX": true
            , "scrollY": false //"200px"
            //, "scrollCollapse": true
            , "paging": false
            //, "ordering": false
            , "columns": [
                { "data": "RecordId", "name": "RecordId", "autoWidth": true }
                , {
                    render: function (data, type, full, meta){
                        return lineNumber_Data__COAL_TEMPERATURE;
                    }
                    , visible: false
                }
                , {
                    render: function (data, type, full, meta) {
                        return '<div style="width:50px !important;">'+
                                '<input type="hidden" id="data_RecordId__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '" value="' + full.RecordId + '"/>' +
                                '<input type="hidden" id="data_still_Edited__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '" value="0"/>' +
                                '<input type="hidden" id="data_Confirm__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '" value="0"/>' +
                                '<i id="data_link_Edit__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '" onclick="javascript:processLink_Edit__COAL_TEMPERATURE(this)" class="fa fa-edit" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'display:none;':'') + '" title="Edit"></i>' +
                                '<i id="data_link_Delete__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '" onclick="javascript:processLink_Delete__COAL_TEMPERATURE(this)" class="fa fa-trash" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'display:none;':'') + '" title="Delete"></i>' +
                                '<i id="data_link_Confirm__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '" onclick="javascript:processLink_Confirm__COAL_TEMPERATURE(this)" class="fa fa-check" style="cursor: pointer;font-size: 20px;color:white;' + (full.RecordId==-1?'':'display:none;') + '" title="Confirm"></i>' +
                                '<i id="data_link_Cancel__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '" onclick="javascript:processLink_Cancel__COAL_TEMPERATURE(this)" class="fa fa-times" style="cursor: pointer;font-size: 20px;color:white;margin-left:10px;' + (full.RecordId==-1?'':'display:none;') + '" title="Cancel"></i>'
                                '</div>'
                                ;
                    }
                    , className: "mercy_action_icon"
                    , orderable: false
                    , width: "50px"
                }
                , {
                    "render": function (data, type, full, meta){
                        return (full.RecordId==-1?'':lineNumber_Data__COAL_TEMPERATURE.toString() + '.');
                    }
                    , className: "mercy_text_right"
                    , orderable: false
                    , width: "20px"
                    , visible: true
                }
                , {
                    "render": function (data, type, full, meta){
                        return '<span id="data_Temperature_label__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '">' + full.Temperature + '</span>' +
                               '<input type="text" id="data_Temperature_txt__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE + '" class="shadow-none mercy_text_101" value="" ' + ' style="width:100px;' + (full.RecordId==-1?'':'display:none;') + '"/>'
                               ;
                    }
                    , orderable: false
                }
            ]
            , "columnDefs": [
                {
                    "targets": [0],
                    "visible": false,
                    "searchable": false
                }
            ]
            //, "order": [[3, 'desc'], [4, 'asc']]
            , "order": [[1, 'asc']]
        });

        obj_html_Table__COAL_TEMPERATURE.on('draw', function () {});
        
        // Resize Table: because this DataTable is newly created
        //resize_Table();
        $("#mercyTable__COAL_TEMPERATURE_wrapper").width('100%');
    }catch(err){}
}

function Populate_DataGrid__COAL_TEMPERATURE(p_data){
    Create_Table__COAL_TEMPERATURE();
    
    // reset
    lineNumber_Data__COAL_TEMPERATURE = 0;
    object_id_Created__COAL_TEMPERATURE = [];
    object_id_Deleted__COAL_TEMPERATURE = [];
    
    try{
        p_data.forEach(
            function (item){
                object_Created_Count__COAL_TEMPERATURE++;
                lineNumber_Data__COAL_TEMPERATURE++;
                object_id_additional__COAL_TEMPERATURE = '_' + object_Created_Count__COAL_TEMPERATURE.toString() + '_' + lineNumber_Data__COAL_TEMPERATURE.toString();
                
                // save to Array
                object_id_Created__COAL_TEMPERATURE.push(object_id_additional__COAL_TEMPERATURE);
                
                // add to Table
                obj_html_Table__COAL_TEMPERATURE.row.add(item).draw(false);
            }
        );
    }catch(err){}
}

function processLink_Add__COAL_TEMPERATURE(){
    if ( ! is_Editable) return;
    
    // create "Record_Item"
    var item = {CreatedOn_Str:'', CreatedOn_Str2:'', FullName:''
                    // flag for "New Record"
                    , RecordId:-1
                    , No:0, Temperature:0
                    , CreatedBy: 0, CreatedOn : null
                    , LastModifiedBy : 0, LastModifiedOn : null}
    
    // do "Counting"
    object_Created_Count__COAL_TEMPERATURE++;
    lineNumber_Data__COAL_TEMPERATURE++;
    object_id_additional__COAL_TEMPERATURE = '_' + object_Created_Count__COAL_TEMPERATURE.toString() + '_' + lineNumber_Data__COAL_TEMPERATURE.toString();
    
    // save to Array
    object_id_Created__COAL_TEMPERATURE.push(object_id_additional__COAL_TEMPERATURE);
    
    // add to Table
    obj_html_Table__COAL_TEMPERATURE.row.add(item).draw(false);
    
    var target_id_additional = '__COAL_TEMPERATURE' + object_id_additional__COAL_TEMPERATURE;
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // Firstly, copy data
    $('#data_No_txt' + target_id_additional).val($('#data_No_label' + target_id_additional).text());
    $('#data_Temperature_txt' + target_id_additional).val($('#data_Temperature_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_No_label' + target_id_additional).hide();
    $('#data_No_txt' + target_id_additional).show();
    $('#data_Temperature_label' + target_id_additional).hide();
    $('#data_Temperature_txt' + target_id_additional).show();
}

function processLink_Edit__COAL_TEMPERATURE(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Edit', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('1');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).hide();
    $('#data_link_Delete' + target_id_additional).hide();
    $('#data_link_Confirm' + target_id_additional).show();
    $('#data_link_Cancel' + target_id_additional).show();
    
    // Firstly, copy data
    $('#data_No_txt' + target_id_additional).val($('#data_No_label' + target_id_additional).text());
    $('#data_Temperature_txt' + target_id_additional).val($('#data_Temperature_label' + target_id_additional).text());
    
    // Secondly, set Show/Hide
    $('#data_No_label' + target_id_additional).hide();
    $('#data_No_txt' + target_id_additional).show();
    $('#data_Temperature_label' + target_id_additional).hide();
    $('#data_Temperature_txt' + target_id_additional).show();
}

function processLink_Cancel__COAL_TEMPERATURE(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Cancel', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // set Show/Hide
    $('#data_No_label' + target_id_additional).show();
    $('#data_No_txt' + target_id_additional).hide();
    $('#data_Temperature_label' + target_id_additional).show();
    $('#data_Temperature_txt' + target_id_additional).hide();
    
    var recordId = $('#data_RecordId' + target_id_additional).val();
    if (recordId == '-1'){
        // this action = 'Create';
    }else{
        // this action = 'Edit';
        return;
    }
    
    try {
        var lineFound = -1;
        var line = 0;
        $.each(object_id_Created__COAL_TEMPERATURE, function( i, val ){
            line++;
            if ('__COAL_TEMPERATURE' + val == target_id_additional)
            {
                lineFound = line;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__COAL_TEMPERATURE + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
        }
    }catch(err){}
}

function processLink_Delete__COAL_TEMPERATURE(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Delete', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('0');
    
    /*if (lineNumber_Data<=1){
        alert('Data is only 1. Please do not delete it!');
        return;
    }
    if (lineNumber_Data<= (object_id_Deleted.length+1)){
        alert('Enough for Delete!');
        return;
    }*/
    
    try {
        var lineFound = -1;
        var line = 0;
        var id_deleted = '';
        
        $.each(object_id_Created__COAL_TEMPERATURE, function( i, val ){
            line++;
            if ('__COAL_TEMPERATURE' + val == target_id_additional)
            {
                lineFound = line;
                id_deleted = val;
            }
        });
        
        if (lineFound >= 0){
            var $rows = $(str_name_Table__COAL_TEMPERATURE + " tr");
            //lineFound--;
            $rows.eq(lineFound).hide();
            
            // save to Array
            object_id_Deleted__COAL_TEMPERATURE.push(id_deleted);
        }
    }catch(err){}
}

function processLink_Confirm__COAL_TEMPERATURE(p_this){
    if ( ! is_Editable) return;
    
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('data_link_Confirm', '');
    
    // Flag
    $('#data_still_Edited' + target_id_additional).val('0');
    $('#data_Confirm' + target_id_additional).val('1');
    
    // "Icons" for Action
    $('#data_link_Edit' + target_id_additional).show();
    $('#data_link_Delete' + target_id_additional).show();
    $('#data_link_Confirm' + target_id_additional).hide();
    $('#data_link_Cancel' + target_id_additional).hide();
    
    // Firstly, copy data
    $('#data_No_label' + target_id_additional).text($('#data_No_txt' + target_id_additional).val());
    $('#data_Temperature_label' + target_id_additional).text($('#data_Temperature_txt' + target_id_additional).val());
    
    // Secondly, set Show/Hide
    $('#data_No_label' + target_id_additional).show();
    $('#data_No_txt' + target_id_additional).hide();
    $('#data_Temperature_label' + target_id_additional).show();
    $('#data_Temperature_txt' + target_id_additional).hide();
}

function processParameters__COAL_TEMPERATURE(){
    var data_Confirmed = '';
    var data_Confirmed_Separator = '';
    var data_Deleted = '';
    var data_Deleted_Separator = '';
    
    try{
        var recordId = null;
        var No = '';
        var Temperature = '';
        
        $.each(object_id_Created__COAL_TEMPERATURE, function(i, val){
            recordId = $('#data_RecordId__COAL_TEMPERATURE' + val).val();
            if (recordId == null || recordId == '' || recordId == '-1'){
                recordId = '-1';
            }
            
            if (object_id_Deleted__COAL_TEMPERATURE.indexOf(val) !== -1){
                // this Row will be Deleted
                data_Deleted += data_Deleted_Separator + recordId;
                data_Deleted_Separator = ',';
            }else if($('#data_Confirm__COAL_TEMPERATURE' + val).val() == '1'){
                No = $('#data_No_txt__COAL_TEMPERATURE' + val).val();
                Temperature = $('#data_Temperature_txt__COAL_TEMPERATURE' + val).val();
                
                data_Confirmed += data_Confirmed_Separator +
                                        recordId +
                                        'xxx' + No +
                                        'xxx' + Temperature
                                        ;
                
                data_Confirmed_Separator = '###';
            }
        });
    }catch(err){}
    
    return data_Confirmed + '+++' + data_Deleted;
}

function isValid__COAL_TEMPERATURE(){
    var result = true;
    var nos = [];
    
    detail_Message = '';
    
    try{
        var recordId = null;
        var No = '';
        var Temperature = '';
        
        $.each(object_id_Created__COAL_TEMPERATURE, function(i, val){
            
            if (object_id_Deleted__COAL_TEMPERATURE.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__COAL_TEMPERATURE' + val).val() == '0'
                     && $('#data_still_Edited__COAL_TEMPERATURE' + val).val() == '1'){
            
                result = false;
            }
        });
        
        if ( ! result){
            detail_Message = 'There is data Coal Temperature still in editing, but not Confirm/Cancel';
            return result;
        }
        
        var no = '';
        
        $.each(object_id_Created__COAL_TEMPERATURE, function(i, val){
            
            if (object_id_Deleted__COAL_TEMPERATURE.indexOf(val) !== -1){
                // this Row will be Deleted
                
            }else if($('#data_Confirm__COAL_TEMPERATURE' + val).val() == '1'){
            
                if ( ! Is_Valid_Numeric('#data_No_txt__COAL_TEMPERATURE' + val)){
                    detail_Message = '[COAL TEMPERATURE] No must Valid Numeric value!';
                    result = false;
                    return result;
                }
                
                if ( ! Is_Valid_Numeric('#data_Temperature_txt__COAL_TEMPERATURE' + val)){
                    detail_Message = '[COAL TEMPERATURE] Temperature must Valid Numeric value!';
                    result = false;
                    return result;
                }
                
                no = $('#data_No_label__COAL_TEMPERATURE' + val).text();
                
                if (nos.indexOf(no) !== -1){
                    detail_Message = '[COAL TEMPERATURE] Data is not valid (duplicate No)';
                    result = false;
                    return result;
                }
                
                // save to Array
                nos.push(no);
                
            }else if($('#data_Confirm__COAL_TEMPERATURE' + val).val() == '0'){
            
                no = $('#data_No_label__COAL_TEMPERATURE' + val).text();
                // save to Array
                nos.push(no);
            }
        });
        
    }catch(err){}
    
    return result;
}

function Calculate_Performance(){

    try{
        $('#C60').text(item_Record.Arrival_Str);  // C11, Arrival Time
        $('#C61').text(item_Record.Arrival_Str);  // C11, Arrival Time
        $('#D61').text(item_Record.Initial_Draft_Str);  // C12, Initial Draft, Hold Cleanless
        $('#D62').text(item_Record.Anchor_Up_Str);  // C13, Anchor Up
        $('#C62').text($('#D61').text());  // D61
        $('#C63').text($('#D62').text());  // D62
        $('#C64').text($('#C63').text());  // C63
        $('#C65').text(item_Record.Berthed_Time_Str);  // C14, BERTHED TIME
        $('#D64').text($('#C65').text());  // C65
        $('#C73').text(item_Record.Commenced_Loading_Str);  // C15, COMMENCED LOADING
        $('#C74').text($('#C73').text());  // C73
        $('#C79').text(item_Record.Completed_Loading_Str);  // C16, COMPLETED LOADING
        $('#C80').text($('#C79').text());  // C79
        $('#D74').text($('#C79').text());  // C79
        $('#C82').text(item_Record.Unberthing_Str);  // C17, UNBERTHING
        $('#D80').text($('#C82').text());  // C82
        $('#C83').text(item_Record.Departure_Str);  // C18, DEPARTURE
        $('#D82').text($('#C83').text());  // C83
        $('#E61').text(diff_hours(item_Record.Initial_Draft, item_Record.Arrival_Time));  // =(D61-C61)*24
        $('#G64').text(diff_hours(item_Record.Berthed_Time, item_Record.Anchor_Up));  // =(D64-C64)*24
        $('#H62').text(diff_hours(item_Record.Anchor_Up, item_Record.Initial_Draft));  // =(D62-C62)*24
        $('#I67').text('0.00');  // 0.0 =(D67-C67)*24
        $('#J69').text('0.00');  // 0.0 =(D69-C69)*24
        $('#K71').text('0.00');  // 0.0 =(D71-C71)*24
        $('#L68').text('0.00');  // 0.0 =(D68-C68)*24
        $('#P76').text('0.00');  // 0.0 =(D76-C76)*24
        $('#Q77').text('0.00');  // 0.0 =(D77-C77)*24
        $('#S75').text('0.00');  // 0.0 =(D75-C75)*24
        $('#T80').text(diff_hours(item_Record.Unberthing, item_Record.Completed_Loading));  // =(D80-C80)*24
        $('#U82').text(diff_hours(item_Record.Departure, item_Record.Unberthing));  // =(D82-C82)*24
        $('#M74').text(diff_hours(item_Record.Completed_Loading, item_Record.Commenced_Loading));  // =(D74-C74)*24-(P76+S75+Q77)
        
        $('#E84').text($('#E61').text());
        $('#F84').text('0.00');
        $('#G84').text($('#G64').text());
        $('#H84').text($('#H62').text());
        $('#I84').text($('#I67').text());
        $('#J84').text($('#J69').text());
        $('#K84').text($('#K71').text());
        $('#L84').text($('#L68').text());
        $('#M84').text($('#M74').text());
        $('#N84').text('0.00');
        $('#O84').text('0.00');
        $('#P84').text($('#P76').text());
        $('#Q84').text($('#Q77').text());
        $('#R84').text('0.00');
        $('#S84').text($('#S75').text());
        $('#T84').text($('#T80').text());
        $('#U84').text('');
        
        $('#M85').text((parseFloat($('#M84').text()) / 24.0).toFixed(2));
        $('#N85').text('0.00');
        $('#O85').text('0.00');
        $('#P85').text((parseFloat($('#P84').text()) / 24.0).toFixed(2));
        $('#Q85').text((parseFloat($('#Q84').text()) / 24.0).toFixed(2));
        $('#R85').text('0.00');
        $('#S85').text((parseFloat($('#S84').text()) / 24.0).toFixed(2));
        
        $('#T85').text((parseFloat($('#M85').text()) + parseFloat($('#P85').text()) 
                     + parseFloat($('#Q85').text()) + parseFloat($('#S85').text())).toFixed(2));
        $('#U85').text('');
    }catch(err){}
}

function Calculate_Performance_Clear(){
    var detail = getUrlParameter('detail');
    
    if (detail == '1') return;
    
    $('#C60').text('');  // C11, Arrival Time
    $('#C61').text('');  // C11, Arrival Time
    $('#D61').text('');  // C12, Initial Draft, Hold Cleanless
    $('#D62').text('');  // C13, Anchor Up
    $('#C62').text('');  // D61
    $('#C63').text('');  // D62
    $('#C64').text('');  // C63
    $('#C65').text('');  // C14, BERTHED TIME
    $('#D64').text('');  // C65
    $('#C73').text('');  // C15, COMMENCED LOADING
    $('#C74').text('');  // C73
    $('#C79').text('');  // C16, COMPLETED LOADING
    $('#C80').text('');  // C79
    $('#D74').text('');  // C79
    $('#C82').text('');  // C17, UNBERTHING
    $('#D80').text('');  // C82
    $('#C83').text('');  // C18, DEPARTURE
    $('#D82').text('');  // C83
    $('#E61').text('');  // =(D61-C61)*24
    $('#G64').text('');  // =(D64-C64)*24
    $('#H62').text('');  // =(D62-C62)*24
    $('#I67').text('');  // 0.0 =(D67-C67)*24
    $('#J69').text('');  // 0.0 =(D69-C69)*24
    $('#K71').text('');  // 0.0 =(D71-C71)*24
    $('#L68').text('');  // 0.0 =(D68-C68)*24
    $('#P76').text('');  // 0.0 =(D76-C76)*24
    $('#Q77').text('');  // 0.0 =(D77-C77)*24
    $('#S75').text('');  // 0.0 =(D75-C75)*24
    $('#T80').text('');  // =(D80-C80)*24
    $('#U82').text('');  // =(D82-C82)*24
    $('#M74').text('');  // =(D74-C74)*24-(P76+S75+Q77)
}

function getFormattedDate(date) {
  var year = date.getFullYear();

  var month = (1 + date.getMonth()).toString();
  month = month.length > 1 ? month : '0' + month;

  var day = date.getDate().toString();
  day = day.length > 1 ? day : '0' + day;
  
  return month + '/' + day + '/' + year;
}

function diff_hours(p_x, p_y){
    var result = 0;
    
    try{
        var parsedDate_x = new Date(parseInt(p_x.substr(6)));
        var d_x = new Date(parsedDate_x);
        
        var parsedDate_y = new Date(parseInt(p_y.substr(6)));
        var d_y = new Date(parsedDate_y);
        
        result = diff_hours_x(d_x, d_y);
    }catch(err){}
    
    return result;
}

function diff_hours_x(p_x, p_y){
    var diff =(p_x.getTime() - p_y.getTime()) / 1000;
    diff /= (60.0 * 60.0);
    //return Math.round(diff, 2);
    return diff.toFixed(2);
}

function CreateDate_Html(p_id){
    return  '<div class="row margin_padding_0" style="min-width:200px !important;">' +
            '<div class="col-md margin_padding_0">' +
            '    <div class="input-group date">' +
            '        <input id="' + p_id + '" class="mercy_select mercy_input_text mercy_date" style="width:120px !important;" data-date-format="dd-M-yyyy" placeholder="dd-M-yyyy" />' +
            '        <div class="input-group-prepend">' +
            '            <span class="input-group-text mercy_date_icon"> </span>' +
            '        </div>' +
            '    </div>' +
            '</div>' +
            '<div class="col-md-auto margin_padding_0" style="margin-left:5px !important;">' +
            '    <div style="width: 60px;margin:auto;">' +
            '        <select id="' + p_id + '_Hours" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;"></select>' +
            '    </div>' +
            '</div>' +
            '<div class="col-md-auto margin_padding_0" style="margin-left:5px !important;margin-top:10px !important;">' +
            '    <div style="width: 5px;margin:auto;">:</div>' +
            '</div>' +
            '<div class="col-md-auto margin_padding_0" style="margin-left:5px !important;">' +
            '    <div style="width: 60px;margin:auto;">' +
            '        <select id="' + p_id + '_Minutes" class="shadow-none custom-select d-block w-100 mercy_select mercy_input_text" style="width:100%;"></select>' +
            '    </div>' +
            '</div>' +
            '</div>'
            ;
}

function CreateDate_DatePicker(p_id, p_value){
    $(p_id).datepicker({
        todayBtn: 1
        , autoclose: true
    }).on('changeDate', function (selected) {
    });
    $(p_id).datepicker('update', new Date());
    
    var d = new Date();
    
    if (p_value != null){
        var parsedDate = new Date(parseInt(p_value.substr(6)));
        d = new Date(parsedDate);
        $(p_id).datepicker('update', d);
    }
    
    Create_ddl_Hours(p_id + '_Hours');
    Create_ddl_Minutes(p_id + '_Minutes');
    
    Set_Hour(p_id + '_Hours', d);
    Set_Minute(p_id + '_Minutes', d);
    
    if (Shift != 2){
        $(p_id).attr("disabled", true);
        $(p_id).addClass('mercy_text_disable');
    }
}

function Create_ddl_Hours(p_id) {
    var obj_html_ddl = $(p_id).select2({
        placeholder: 'Select'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
    });
    
    var option = null;
    var str = '';
    for (var i=0;i<=23;i++){    
        if (i<10){
            str = '0' + i.toString();
        }
        else str = i.toString();
        
        option = new Option(str, str, true, true);
        obj_html_ddl.append(option);//.trigger('change');
    }
}

function Create_ddl_Minutes(p_id) {
    var obj_html_ddl = $(p_id).select2({
        placeholder: 'Select'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
    });
    
    var option = null;
    var str = '';
    for (var i=0;i<=59;i++){    
        if (i<10){
            str = '0' + i.toString();
        }
        else str = i.toString();
        
        option = new Option(str, str, true, true);
        obj_html_ddl.append(option);//.trigger('change');
    }
}

function Set_Hour(p_id, p_date){
    var h = p_date.getHours();
    
    //h = h % 12;
    
    var str = '';
    if (h<10){
        str = '0' + h.toString();
    }
    else str = h.toString();
    
    $(p_id).val(str).trigger('change');
}

function Set_Minute(p_id, p_date){
    var m = p_date.getMinutes();
    
    var str = '';
    if (m<10){
        str = '0' + m.toString();
    }
    else str = m.toString();
        
    $(p_id).val(str).trigger('change');
}

function FinalizeData() {
    if ( ! is_Draft){
        alert("Status: already Final!");
        return;
    }
    
    $('#imgLoading').show();

    var action = 'Finalize?.id=' + paramid;
    
    $.ajax({
        url: api_Request + '/Api/LoadingActual/' + action,
        data: {},
        type: 'POST',
        dataType: "json",
        cache: false,
        beforeSend: function (request) {
            request.setRequestHeader(MERCY_Token, MERCY_Token_Value);
        },
        success: function (data) {
            $('#imgLoading').hide();

            if ( ! $.trim(data)) {
                // empty data
                return;
            }
            
            if ( ! data.Success){
                alert(data.Message);
                return;
            }
            
            alert('Success Finalize');
            window.location = mercyUrl('/LoadingActualv');
        },
        error: function (error) {
            //$(this).remove();
        }
    });
}

var object_Created_Count__File_Upload = 0;
var object_id_Created__File_Upload = [];
var object_id_Deleted__File_Upload = [];

function btnChooseFile_Click(){
    if ( ! is_Editable) return;

    object_Created_Count__File_Upload++
    
    var str = '<input id="fileInput_Upload_' + object_Created_Count__File_Upload.toString() + '" style="display: none !important;" type="file" onChange="file_onChange(this)"/>';

    $('#files_Uploads_TextBox').append(str);

    $('#fileInput_Upload_' + object_Created_Count__File_Upload.toString()).click();
}

function file_onChange(p_this){
    var target_id = p_this.id;
    var target_id_additional = target_id.replace('fileInput_Upload_', '');

    var fileName = $('#' + target_id)[0].files[0].name;
    
    var str = '<span id="fileInput_Display_a_' + target_id_additional + '" class="fa fa-times" onClick="file_Delete(this)" style="cursor: pointer;margin-right:5px;"></span>' +
              '<span id="fileInput_Display_b_' + target_id_additional + '" style="margin-right:20px;">' + fileName + '</span>' +
              '<input id="fileInput_Display_c_' + target_id_additional + '" value="-1" type="hidden"/>';
    $('#files_Uploads').append(str);

    // save to Array
    object_id_Created__File_Upload.push(target_id_additional);
}

function file_Delete(p_this){
    if ( ! is_Editable) return;

    var target_id = p_this.id;
    var target_id_additional = target_id.replace('fileInput_Display_a_', '');

    $('#fileInput_Display_a_' + target_id_additional).hide();
    $('#fileInput_Display_b_' + target_id_additional).hide();

    // save to Array
    object_id_Deleted__File_Upload.push(target_id_additional);
}

function Populate_Attachments(p_data){
    // reset
    object_Created_Count__File_Upload = 0;
    object_id_Created__File_Upload = [];
    object_id_Deleted__File_Upload = [];
    
    try{
        p_data.forEach(
            function (item){
                object_Created_Count__File_Upload++;
                
                var str = '<span id="fileInput_Display_a_' + object_Created_Count__File_Upload + '" class="fa fa-times" onClick="file_Delete(this)" style="cursor: pointer;margin-right:5px;"></span>' +
                          '<span id="fileInput_Display_b_' + object_Created_Count__File_Upload + '" style="cursor: pointer;margin-right:20px;">' + item.FileName + '</span>' +
                          '<input id="fileInput_Display_c_' + object_Created_Count__File_Upload + '" value="' + item.RecordId + '" type="hidden"/>';
                $('#files_Uploads').append(str);

                $('#fileInput_Display_b_' + object_Created_Count__File_Upload).on('click', function (e) {
                    e.preventDefault();  //stop the browser from following
                    var url = '/Api/File/Download?.id=' + item.FileName2;
                    window.location.href = url;
                });
            }
        );
    }catch(err){}
}

function Create_ddl_TugName() {
    if (obj_html_TugName != null) return;

    obj_html_TugName = $('#ddl_TugName').select2({
        placeholder: 'Select Tug Name'
        , tags: false
        , multiple: false
        //, tokenSeparators: [',', ' ']
        //, minimumInputLength: 3
        , minimumResultsForSearch: -1
    });

    $('#ddl_TugName').change(function (e) {
        OnChange_ddl_TugName();
    });
}

function OnChange_ddl_TugName() {
    if (ignore_trigger_change_ddl_TugName) return;
    
    $('#txtTugName').val($('#ddl_TugName').val());
    
    $('#txtNoRefReport').val('');
    $('#txtNoServicesTrip').val('');
    $('#txtBargeName').val('');
    $('#txtBargeSize').val('');
    $('#txtRoute').val('');
    $('#txtLoadType').val('');
    
    var selectedValue = $('#ddl_TugName').val();
    
    Default_Actual.forEach(
        function (item) {
            if (item.Tug_Name == selectedValue){
                $('#txtRequest_Id').val(item.Request_Id);
                $('#txtNoRefReport').val(item.No_Ref_Report);
                $('#txtNoServicesTrip').val(item.No_Service_Trip);
                $('#txtBargeName').val(item.BargeName);
                $('#txtBargeSize').val(item.BargeSize);
                $('#txtRoute').val(item.Route);
                $('#txtLoadType').val(item.LoadType);
            }
        }
    );
}

function Clear_ddl_TugName() {
    // Clear DropdownList
    //$('#ddl_TugName').html('').select2({ data: { id: null, text: null } });

    Create_ddl_TugName();
}

function Populate_Data_ddl_TugName() {
    try {
        var option = null;

        Default_Actual.forEach(
            function (item) {
                // create the option and append to Select2
                option = new Option(item.Tug_Name, item.Tug_Name, true, true);
                obj_html_TugName.append(option);//.trigger('change');
            }
        );

        // Inisial value for "Site"
        ignore_trigger_change_ddl_TugName = true;
        $('#ddl_TugName').val('').trigger('change');
        ignore_trigger_change_ddl_TugName = false;
    }catch(err){}
}

</script>
